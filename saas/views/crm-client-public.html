<!DOCTYPE html>
<html lang="zh-CN">

	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=Edge">
		<meta charset="utf-8" />
		<title>公海</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="../resources/css/bootstrap.min.css" />
		<link rel="stylesheet" href="../resources/css/bootstrap-theme.min.css" />
		<link rel="stylesheet" href="../resources/css/jquery.gritter.css" />
		<link rel="stylesheet" href="../resources/css/ui.jqgrid.css" />
		<link rel="stylesheet" href="../resources/css/font-awesome.min.css" />
		<link rel="stylesheet" href="../resources/css/datepicker.css" />
		<link rel="stylesheet" href="../resources/css/main-page.css" />
		<link rel="stylesheet" href="../resources/css/hgf.css" />
		<style type="text/css">
			.content-main {
				width: 100%;
				/*min-width: 1200px;*/
			}
			
			.content-main-left {
				width: 200px;
				height: 100%;
				font-weight: bold;
				border-right: 1px solid #e3e3e3;
			}
			
			.content-main-left-link {
				display: inline-block;
				width: 100%;
				text-align: center;
				border-bottom: 1px solid #e3e3e3;
				line-height: 40px;
			}
			
			.movepubilc-info .search .form-inline.first-form-inline .btn-search {
				top: 10px;
			}
			
			.btn[disabled] {
				cursor: not-allowed;
			}
			
			.tree {
				padding-left: 0;
			}
			
			.content-main-left .menu-top {
				/*margin-left: 10px;*/
				margin-top: 10px;
				width: 200px;
				overflow: auto!important;
			}
			
			.menu-top li {
				cursor: pointer;
				line-height: 25px;
			}
			
			.menu-top li li {
				margin-left: 8px;
			}
			
			.content-main-right {
				position: relative;
				padding-top: 10px;
				margin-left: 210px;
			}
			
			.list-box-top {
				padding-left: 10px;
				padding-top: 10px;
				height: 80px;
			}
			
			.list-box-top-info {
				width: 80%;
			}
			
			.box-top-name {
				font-weight: bold;
				font-size: 20px;
				line-height: 30px;
				display: inline-block;
				width: 55%;
				overflow: hidden;
				text-overflow: ellipsis;
				white-space: nowrap;
			}
			
			.box-top-hospitalgrade,
			.box-top-clientgrade {
				margin-left: 20px;
				color: #666666;
			}
			
			.hospitalregion {
				line-height: 30px;
			}
			
			.record span {
				margin-right: 5px;
			}
			
			.state-bad {
				display: inline-block;
				width: 70px;
				height: 30px;
				border-radius: 1px;
				-webkit-border-radius: 1px;
				-moz-border-radius: 1px;
				background: #BD0000;
				color: #fff;
				line-height: 30px;
				text-align: center;
			}
			
			.list-box-main {
				border-top: 1px solid #E4E4E4;
				border-bottom: 1px solid #E4E4E4;
				padding-left: 10px;
				padding-right: 10px;
			}
			
			.box-main-left {
				width: 80%;
				padding: 20px 0;
			}
			
			.box-main-left p {
				line-height: 30px;
			}
			
			.box-main-name {
				display: inline-block;
				width: 100px;
				text-align: left;
				margin-right: 100px;
			}
			
			.box-main-right div {
				width: 70px;
				height: 70px;
				border-radius: 35px;
				-webkit-border-radius: 35px;
				-moz-border-radius: 35px;
				border: 1px solid #D6D6D6;
				text-align: center;
				line-height: 70px;
			}
			
			.box-main-right-dispose {
				position: relative
			}
			
			.disposenum {
				display: inline-block;
				color: #fff;
				background: #BD0000;
				width: 20px;
				height: 20px;
				border-radius: 10px;
				-webkit-border-radius: 10px;
				-moz-border-radius: 10px;
				line-height: 20px;
				position: absolute;
				top: 40px;
			}
			
			.list-box-bottom {
				line-height: 40px;
				text-indent: 1rem;
			}
			
			.hot {
				position: absolute;
				top: -10px;
				left: -17px
			}
			
			.movepubilc-nav {
				border: 1px solid #e3e3e3;
				zoom: 1;
				border-bottom: 0;
				margin-top: 10px;
				background-color: #f8f8f8;
				border-left: 0;
				width: 100%;
			}
			
			.movepubilc-nav:after {
				content: ".";
				display: block;
				height: 0;
				clear: both;
				visibility: hidden;
			}
			
			.movepubilc-nav li {
				float: left;
				border: 1px solid #e3e3e3;
				border-bottom: 0;
				text-align: center;
				padding: 0 16px;
				height: 38px;
				line-height: 38px;
				cursor: pointer;
				border-top: 0;
			}
			
			.movepubilc-nav li:first-child {
				border-left: 1px solid #e3e3e3;
			}
			
			.movepubilc-nav li.chenkstyle {
				background-color: #85beeb;
				color: #fff;
				border: 0;
			}
			
			.movepubilc-info {
				/*border-bottom: 1px solid #ddd;*/
			}
			
			.movepubilc-info input {
				margin: 10px 0;
				margin-left: 10px;
			}
			
			.movepubilc-info input[type=text] {
				/*width: 300px;*/
			}
			
			.movepubilc-btn {
				text-align: center;
				padding: 10px 0;
			}
			
			.movepubilc-btn input {
				margin-left: 10px;
			}
			
			.client-info-top {
				height: 141px;
				margin-top: 15px;
				margin-left: 15px;
			}
			
			.client-info-bottom {
				margin-left: 15px;
				margin-top: 20px;
			}
			
			.client-info-top-menu {
				text-align: left;
			}
			
			.client-info-top-menu .info-name {
				font-weight: bold;
				font-size: 18px;
				display: inline-block;
				overflow: hidden;
				width: auto;
				color: #333;
				text-overflow: ellipsis;
				white-space: nowrap;
			}
			
			.client-info-top-menu .area-cn {
				vertical-align: top;
				margin: 0!important;
				margin-top: 3px!important;
			}
			
			.client-info-top-menu .data-name {
				font-size: 12px;
				color: #999;
				margin-right: 3px!important;
				margin-left: 0!important;
			}
			
			.client-info-top-menu .data-detail {
				font-size: 12px;
				color: #666;
				margin-right: 20px;
				margin-left: 0!important;
			}
			
			.group-handle {
				vertical-align: top;
				margin-left: 6px!important;
			}
			
			.client-info-top-menu .info-name~span {
				display: inline-block;
			}
			
			.client-info-top-tab {
				border: 1px solid #ddd;
				width: 100%;
				margin-bottom: 20px;
				margin-top: 7px;
				padding: 15px 0;
				height: 84px;
			}
			
			.client-info-top-tab span {
				line-height: 14px;
			}
			
			.client-info-top-tab>div {
				width: 25%;
				height: 50px;
			}
			
			.client-info-top-tab>div:last-child .right-line {
				border-right: 0;
			}
			
			.client-info-top-tab>div .right-line {
				display: block;
				height: 20px;
				border-right: 1px solid #eee;
				margin: -3px 0;
			}
			
			.client-info-top-tab span {
				display: inline-block;
				text-align: center;
				width: 100%;
				font-size: 12px;
				color: #999;
				height: 14px;
			}
			
			.client-info-top-tab span[bind] {
				font-size: 14px;
				color: #333;
			}
			
			.client-info-tab {
				border: 1px solid #e3e3e3;
				border-top: 0;
				border-left: 0;
				height: auto;
			}
			
			.client-info-offbtn {
				display: block;
				margin: 10px auto;
				margin-top: 10px;
				margin-left: 45%;
			}
			
			.department-tree li {
				line-height: 20px;
				cursor: pointer;
			}
			
			.department-tree li li {
				text-indent: 20px;
			}
			
			.department-tree li li li {
				text-indent: 40px;
			}
			
			.rob-client {
				position: relative;
				height: 100%;
			}
			
			.rob-client .step-panel-1 {
				height: 87%;
				margin: 10px 0;
			}
			
			.rob-client .step-panel-1>ul {
				border: 1px solid #ddd;
				height: 94%;
				padding: 10px;
			}
			
			.rob-client .rob-client-fotter-btns {
				position: absolute;
				margin: 20px 0;
				bottom: 0;
				left: 0;
				right: 0;
				padding-left: 40%;
				border-top: 1px solid #ddd;
				padding-top: 10px;
			}
			
			.rob-client .rob-client-fotter-btns a {
				margin-right: 20px;
			}
			
			.rob-client-left {
				height: 100%;
				width: 100%;
				overflow: auto;
			}
			
			.fa-sort-desc {
				vertical-align: text-top;
			}
			
			.rob-client-right {
				width: 100%;
			}
			
			.rob-client-right .form-inline label {
				width: 100px;
				vertical-align: top;
				text-align: right;
				margin-right: 10px;
				color: #666;
			}
			
			.rob-client-right .form-inline {
				margin-bottom: 20px;
				font-size: 14px;
				color: #999;
			}
			
			.rob-client-right .form-inline-sale {
				float: left;
			}
			
			.rob-client-right .form-inline-sale input {
				border: none;
				border-bottom: 1px solid #999;
				color: #CA192B;
				text-align: center;
			}
			
			.info-title {
				font-weight: bold;
				font-size: 20px;
				margin: 0!important;
			}
			
			.apple-list-additioninfo {
				border: 1px solid #ccc;
				border-radius: 5px;
				-webkit-border-radius: 5px;
				-moz-border-radius: 5px;
				margin: 10px auto;
				line-height: 40px;
			}
			
			.apple-list-additioninfo>span {
				display: inline-block;
				width: 30%;
				text-align: center;
			}
			
			.apple-list-additioninfo>span>span {
				margin-left: 30px;
			}
			
			.apple-list-main-left {
				width: 30%;
				border: 1px solid #CA192B;
			}
			
			.apple-list-main-left>div {
				margin-bottom: 10px;
			}
			
			.apple-list-main-right {
				width: 68%;
				height: 100%;
				overflow-y: auto;
			}
			
			.apple-list-main-left {
				height: 100%;
				overflow-y: auto;
				overflow-x: hidden;
			}
			
			.apple-list-main-left .rob-menu,
			.apple-list-main-left .rob-list {
				/*height: 28px;*/
				line-height: 28px;
				margin-bottom: 5px;
			}
			
			.apple-list-main-left .rob-menu .rob-detail,
			.apple-list-main-left .rob-list .rob-detail {
				display: block;
				/*margin-left: 70px;*/
				word-wrap: break-word;
				word-break: break-all;
			}
			
			.apple-list-main-left .rob-list .label-name {
				/*float: left;*/
				/*width: 90px;*/
				text-align: right;
				color: #666;
			}
			
			.rob-menu {
				background-color: #f3f3f3;
				padding-left: 14px;
			}
			
			.apple-list-bottom {
				border-top: 1px solid #ccc;
				margin-top: 20px;
			}
			
			.apple-list-box {
				border: 1px solid #e3e3e3;
				margin: 10px 0;
			}
			
			.apple-list-box:first-child {
				margin-top: 0;
			}
			
			.apple-list-box.clickstyle {
				background: #DCDCDC;
			}
			
			.applyfor-state {
				margin: 5px;
			}
			
			.apple-list-box-top {
				border-bottom: 1px solid #ccc;
				/*line-height: 40px;*/
			}
			
			.crm-client-public .apple-list-box-top>span {
				display: inline-block;
			}
			
			.list-box-name {
				/*width: 15%;*/
				text-align: right;
				display: inline-block;
				font-size: 14px;
				color: #666;
				min-width: 0;
			}
			
			.list-box-time {
				color: #999;
			}
			
			.apple-list-box-bottom {
				height: 46px;
				line-height: 23px;
			}
			
			.box-bottom-span {
				display: inline-block;
				width: 80%;
				text-align: center;
				font-size: 16px;
				line-height: 40px;
			}
			
			.apple-list-box-bottom>span span {
				display: inline-block;
				color: #FDA624;
				font-size: 40px;
				margin-left: 10px;
				margin-right: 10px;
			}
			
			.apple-list-box-bottom>input {
				margin: 5px;
				height: 30px;
				background: #fff;
				line-height: 20px;
				border: 1px solid #e3e3e3;
				border-radius: 5px;
				-webkit-border-radius: 5px;
				-moz-border-radius: 5px;
			}
			
			.apple-list-bottom {
				line-height: 30px;
			}
			
			.rob-plan {
			}
			
			.state-show {
				display: inline-block;
				width: 70px;
				height: 30px;
				background: #008000;
				text-align: center;
				line-height: 30px;
				color: #fff;
				margin: 5px 0;
			}
			
			.item-header .label {
				font-weight: normal;
			}
			
			.content-left {
				/*border-right: 1px solid #ccc;*/
			}
			
			.content-left:after,
			.content-left-body-main:after,
			.hand-over-client-panel:after {
				content: "";
				display: block;
				clear: both;
			}
			
			.content-left-body-title {
				background-color: #f2f2f2;
			}
			
			.content-left-body-title div {
				display: inline-block;
				vertical-align: top;
				text-align: center;
				width: 217px;
			}
			
			.sel-area-title {
				color: #333;
			}
			
			.sel-area-explain-title {
				color: #999;
			}
			
			.sel-area-main {
				min-height: 461px;
				overflow-y: scroll;
				border-left: 1px solid #ccc;
				border-bottom: 1px solid #ccc;
			}
			
			#tab-hand-over-content {
				width: 100%;
				border: 1px solid #f2f2f2;
				border-collapse: collapse;
			}
			
			#tab-hand-over-content td,
			#tab-hand-over-content th {
				/*width: 224px;*/
				text-align: center;
				/*padding: 5px 0;*/
				border: 1px solid #f2f2f2;
			}
			
			#tab-hand-over-content thead th {
				color: #333;
				background-color: #f2f2f2;
				font-weight: normal;
			}
			
			#tab-hand-over-content tbody ul li {
				border-bottom: 1px solid #ccc;
			}
			
			#tab-hand-over-content tbody ul li:last-child {
				border: none;
			}
			
			#tab-hand-over-content tbody tr td a,
			#tab-hand-over-content tbody tr td a:hover,
			#tab-hand-over-content tbody tr td a:focus {
				color: red;
				text-decoration: none;
				cursor: pointer;
			}
			
			.view-accept-object span {
				display: inline-block;
				margin-left: 15px;
				padding: 10px;
			}
			
			.fa-unchecked {
				color: #999;
				display: inline-block;
				margin: 0 5px;
			}
			
			.fa-checked {
				color: #169BD5!important;
				display: inline-block;
				margin: 0 5px;
			}
			
			.hand-over-active {
				display: block;
			}
			
			.hand-over-hide {
				display: none;
			}
			
			.selected-active {
				background-color: #EFF4FF;
			}
			
			.content-left-body-main ul li {
				margin: 0;
			}
			
			.all-dept-ul,
			.second-dept-ul,
			.third-dept-ul,
			.all-area-ul,
			.second-government-area,
			.third-government-area {
				margin-left: 15px;
			}
			
			.sel-nationwide {
				cursor: default;
			}
			
			.sel-hand-over-emp {
				color: #999;
				font-weight: bold;
			}
			
			.sel-hand-over-emp-active,
			.sel-hand-over-emp:hover,
			.sel-hand-over-emp:focus {
				color: #12BDF7;
				text-decoration: none;
			}
			
			#allmap {
				height: 500px;
				width: 100%;
			}
			
			#r-result {
				width: 100%;
				font-size: 14px;
			}
			
			.share-status,
			.share-status:hover,
			.share-status:focus {
				display: inline-block;
				width: 55px;
				height: 25px;
				border: 1px solid #ddd;
				border-radius: 8px;
				text-align: center;
				line-height: 25px;
				cursor: pointer;
				color: #fff;
				text-decoration: none;
			}
			
			.client-tree i {
				text-indent: 0;
			}
			
			.fa-check-circle {
				color: #B5B5B5;
			}
			
			i.checkstyle {
				color: #169BD5;
			}
			
			.client-tree li {
				line-height: 25px;
				cursor: pointer;
			}
			
			.client-tree li li {
				text-indent: 15px;
			}
			
			.client-tree li li li {
				text-indent: 30px;
			}
			
			.shake-client-left {
				width: 220px;
				height: 600px;
				border-right: 1px solid #ccc;
				text-align: center;
			}
			
			.shake-client-left>input {
				border: 1px solid #ccc;
				background: #fff;
				border-radius: 3px;
				-webkit-border-radius: 3px;
				-moz-border-radius: 3px;
				margin-bottom: 40px;
				width: 170px;
				height: 40px;
				line-height: 40px;
				text-align: center;
			}
			
			.share-list ul {
				border: 1px solid #ccc;
				border-right: 0;
				text-align: left;
			}
			
			.share-list ul li {
				border-top: 1px solid #ccc;
				height: 50px;
				padding: 5px;
			}
			
			.share-list li.clickstyle {
				box-shadow: 0 0 3px #000;
			}
			
			.share-list ul li:first-child {
				border: 0;
			}
			
			.share-list ul li>p:first-child {
				color: #ccc;
			}
			
			.share-list ul li>p:last-child {
				line-height: 30px;
			}
			
			.share-list ul li>p span {
				margin-left: 10px;
			}
			
			.share-list ul li>p i {
				margin-right: 10px;
				font-size: 20px;
			}
			
			.shake-client-right {
				width: 800px;
			}
			
			.share-info {
				width: 350px;
			}
			
			.share-info>ul {
				width: 100%;
				height: 570px;
				margin-top: 10px;
				border: 1px solid #ccc;
				border-radius: 5px;
				-webkit-border-radius: 5px;
				-moz-border-radius: 5px;
				padding: 10px;
				overflow: auto;
			}
			
			.tree-status {
				float: right;
				margin-right: 20px;
				font-size: 20px;
			}
			
			.tree-status i {
				color: #ccc;
			}
			
			.tree-status i.checkstyle {
				color: #169BD5;
			}
			
			.share-object {
				width: 400px;
			}
			
			.share-object>p {
				line-height: 30px;
				margin-bottom: 10px;
			}
			
			.share-object p a {
				float: right;
			}
			
			.share-object .share-object-list {
				border: 1px solid #ccc;
				height: 250px;
				zoom: 1;
				padding: 10px;
				margin-bottom: 10px;
			}
			
			.share-object-list:after {
				content: "";
				height: 0;
				display: block;
				clear: both;
				visibility: hidden;
			}
			
			.object-box {
				width: 55px;
				height: 70px;
				margin-left: 25px;
				margin-bottom: 10px;
				float: left;
				position: relative;
			}
			
			.object-box:nth-child(5n+1) {
				margin-left: 0;
			}
			
			.object-box img {
				width: 55px;
				height: 55px;
			}
			
			.object-box-off {
				cursor: pointer;
				position: absolute;
				top: 5px;
				left: 40px;
				width: 16px;
				height: 16px;
				background: red;
				color: #fff;
				border: 1px solid #ccc;
				border-radius: 8px;
				-webkit-border-radius: 8px;
				-moz-border-radius: 8px;
				text-align: center;
				line-height: 12px;
			}
			
			.object-box-name {
				line-height: 20px;
				font-size: 14px;
				text-align: center;
			}
			
			.share-object-reason {
				width: 100%;
				resize: none;
				height: 100px;
			}
			
			.tree-dept-menu-government-area li {
				margin-left: 15px;
			}
			
			.input-label-group .city-picker-span {
				width: 171px;
			}
			
			.dept-tree {
				color: #333;
			}
			
			.sel-area-client-contact-ul span {
				color: #333;
			}
			
			.applyfor-reason label {
				display: inline-block;
				width: 100%;
			}
			
			.applyfor-indicators {
				margin: 10px 0;
			}
			
			.indicators-text {
				margin: 0 10px;
			}
			
			.applyfor-reason textarea {
				resize: none;
				width: 100%;
				height: 100px;
				margin-top: 10px;
			}
			
			.all-deptwide {
				display: block;
			}
			
			.my-client,
			.my-subordinates-client,
			.share-to-me-client {
				cursor: pointer;
				margin-left: 15px;
			}
			
			.content-left-body-company,
			.content-left-body-contacts {
				float: left;
				width: 50%;
				height: 500px;
				overflow: auto;
			}
			
			.content-left-body:after {
				content: "";
				display: block;
				clear: both;
			}
			
			.hand-over-foot-btn {
				margin-left: 60%;
				margin-top: 20px;
				position: relative;
				z-index: 999;
			}
			
			.sel-area-client-company-ul>li li {
				margin-left: 15px;
			}
			
			.sel-area-title {
				display: inline-block;
				height: 30px;
				width: 100%;
				background-color: #f2f2f2;
				text-align: center;
				margin-bottom: 5px;
			}
			
			.steps-panel {
				height: 500px;
			}
			
			.select-scope-deparmenttree {
				margin: 10px 20px;
			}
			
			.select-scope-deparmenttree li {
				line-height: 25px;
			}
			
			.select-scope-deparmenttree li input {
				margin-right: 5px;
			}
			
			.select-scope-deparmenttree li i {
				margin-right: 5px;
			}
			
			.select-scope-deparmenttree>li {
				margin-left: 15px;
			}
			
			.select-scope-deparmenttree li li {
				margin-left: 30px;
			}
			
			.select-scope-deparmenttree>li>li>li {
				margin-left: 45px;
			}
			
			.content-main-right-list {
				zoom: 1;
				/*height: 96%;*/
				overflow: auto;
				/*padding-left: 15px;*/
			}
			
			.content-main-right-list:after {
				content: ".";
				height: 0;
				display: block;
				clear: both;
				visibility: hidden;
			}
			
			.client-pubilc-page {
				height: 30px;
				line-height: 30px;
				border: 1px solid #ccc;
				/*border-left: 0;*/
			}
			
			.client-pubilc-page i {
				cursor: pointer;
			}
			
			.public-page {
				float: left;
				padding: 0 10px;
			}
			
			.history-curr-pager {
				width: 45px;
				line-height: 16px;
				text-align: center;
			}
			
			.vert-top {
				vertical-align: top;
			}
			
			.my-client-list {
				width: 690px!important;
				height: 380px!important;
				overflow: hidden;
			}
			/*新样式*/
			
			.page-container,
			.page-container .content {
				padding: 0;
			}
			
			.color-gray {
				color: #999;
				font-size: 12px;
			}
			
			.color-black {
				color: #333;
			}
			
			.color-gray-black {
				color: #666;
			}
			
			.font-blod {
				font-weight: bold;
			}
			
			.font-size-15 {
				font-size: 15px;
			}
			
			.font-size-16 {
				font-size: 16px;
			}
			
			.page-crm-sea {}
			
			.page-crm-sea .sea-client-item {
				width: calc(100% / 2 - 20px);
				min-width: 500px;
				float: left;
				margin: 7px 10px 12px 10px;
				border: 1px solid #e3e3e3;
				-moz-box-shadow: 0 1px 5px #eee;
				-webkit-box-shadow: 0 1px 5px #eee;
				box-shadow: 0 1px 5px #eee;
				cursor: pointer;
			}
			
			.page-crm-sea .sea-client-item .item-header {
				padding: 10px;
				border-bottom: 1px solid #e3e3e3;
				padding-top: 20px;
				padding-bottom: 0;
			}
			
			.page-crm-sea .sea-client-item .item-header .mata {
				font-size: 13px;
				padding: 4px 0 10px 0;
			}
			
			.page-crm-sea .sea-client-item .item-header .mata .lab {
				padding-right: 10px;
			}
			
			.page-crm-sea .sea-client-item .item-wrap {
				height: 80px;
				padding: 10px;
			}
			
			.page-crm-sea .sea-client-item .item-wrap .table-count tr th,
			.page-crm-sea .sea-client-item .item-wrap .table-count tr td {
				width: 30%;
				padding: 5px;
				text-align: center;
			}
			
			.page-crm-sea .sea-client-item .item-footer {
				height: 45px;
				padding: 10px;
				border-top: 1px solid #e3e3e3;
				background-color: #f3f3f3;
				font-size: 13px;
			}
			
			.page-crm-sea .sea-client-item .item-footer .lb {
				padding-right: 10px;
			}
			
			.page-crm-sea .sea-client-item .item-footer .btn {
				width: 60px;
				padding: 2px 10px;
			}
			
			.page-crm-sea .sea-client-item .left {
				width: 70%;
				;
				float: left;
			}
			
			.page-crm-sea .sea-client-item .right {
				width: 30%;
				float: right;
				text-align: right;
			}
			
			.page-crm-sea .sea-client-item .item-header .mata .left,
			.page-crm-sea .sea-client-item .item-header .mata .right {
				width: 50%;
			}
			
			.css-overhidden {
				max-width: 150px;
			}
			
			.fotter-btn-container {
				height: 90px;
				line-height: 90px;
				text-align: center;
				border-top: 1px solid #eee;
			}
			
			.fotter-btn-container a {
				height: 30px;
				line-height: 15px;
				width: 175px;
			}
			
			.tree .top-line:before {
				margin-left: -8px!important;
				width: 12px!important;
			}
			
			.tree>li ul>li:last-child:before {
				margin-left: -9px!important;
				width: 13px!important;
			}
			
			.item-header .label-default {
				background-color: #aaa;
			}
			
			.item-header .css-overhidden {
				font-size: 18px;
			}
			
			.item-header .text-danger {
				color: #ca192b;
				font-size: 12px;
				font-weight: normal;
				display: inline-block;
				margin-top: -5px;
				font-style: italic;
			}
			
			.item-footer .text-danger {
				font-family: arial;
				font-size: 12px;
				font-weight: normal;
				display: inline-block;
			}
			
			.item-footer .btn {
				font-size: 12px;
			}
			
			.item-wrap td {
				font-size: 14px;
				color: #333;
			}
			
			.item-wrap th {
				font-size: 12px;
				color: #999;
				font-weight: normal;
			}
			
			.record img {
				width: 20px;
			}
			
			.content-left:after,
			.content-left-body-main:after,
			.hand-over-client-panel:after {
				content: "";
				display: block;
				clear: both;
			}
			
			.content-left-body-title {
				background-color: #f2f2f2;
			}
			
			.content-left-body-title div {
				display: inline-block;
				vertical-align: top;
				text-align: center;
				width: 217px;
			}
			
			.content-left-body-company,
			.content-left-body-contacts {
				float: left;
				width: 50%;
			}
			
			.content-left-body:after {
				content: "";
				display: block;
				clear: both;
			}
			
			.content-left-companys-container {
				border: 1px solid #ddd;
				margin-bottom: 20px;
			}
			
			.content-left-companys-container>label {
				background-color: #f8f8f8;
				color: #666;
				font-size: 14px;
				font-weight: bold;
				padding: 10px 14px;
				display: block;
				border-bottom: 1px solid #ddd;
			}
			
			.content-left-companys {
				padding: 14px;
			}
			
			.content-left-companys .client-name {
				display: inline-block;
				font-size: 14px;
				color: #666;
				padding: 6px 6px 6px 6px;
				border-bottom: 1px dashed #eee;
				cursor: pointer;
				margin-right: 5px;
				text-align: center;
			}
			
			.content-left-companys .client-name.active {
				font-size: 14px;
				color: #fff!important;
				background-color: #009ED8;
				text-decoration: none!important;
				border-bottom: none;
			}
			
			.content-left-companys .client-name.select,
			.content-left-companys .client-name.active.select {
				font-size: 14px;
				color: #009ED8;
				text-decoration: underline;
			}
			
			.content-left-body {
				border: 1px solid #ddd;
				height: 360px;
			}
			
			.content-left-body>label {
				background-color: #fffbec;
				font-size: 12px;
				color: #88744f;
				padding: 8px 0 6px 14px;
				display: block;
			}
			
			.content-left-body .one-client-detail {
				height: 320px;
				overflow-y: auto;
			}
			
			.content-left-body .one-client-detail li {
				margin-left: 17px;
				padding-top: 14px;
			}
			
			.content-left-body .one-client-detail li label {
				margin: 0;
			}
			
			.content-left-body .one-client-detail li input {
				margin-right: 5px;
				width: 13px;
				height: 13px;
				border: 1px solid #8e8f8f;
				vertical-align: top;
			}
			
			.hand-over-object-reason .form-inline,
			.hand-over-object-reason .form-control {
				display: inline-block;
				width: 100%;
				margin-bottom: 14px;
			}
			
			.receive-obj-container  {
				display: inline-block;
				width: 75%;
			}
			
			.hand-over-object-reason .form-control {
				border: 1px solid #eee;
				border-radius: 0;
				width: 75%;
				height: 140px;
			}
			
			.hand-over-object-reason label {
				vertical-align: top;
			}
			
			.btn-sel-accept-object {
				margin-left: 5px;
			}
			
			#tab-hand-over-content {
				width: 100%;
				border: 1px solid #f2f2f2;
				border-collapse: collapse;
			}
			
			#tab-hand-over-content td,
			#tab-hand-over-content th {
				text-align: left;
				/*padding: 5px 0;*/
				border: 1px solid #f2f2f2;
			}
			
			#tab-hand-over-content thead th {
				color: #333;
				background-color: #f2f2f2;
				font-weight: normal;
			}
			
			#tab-hand-over-content tbody ul li {
				border-bottom: 1px solid #ccc;
			}
			
			#tab-hand-over-content tbody ul li:last-child {
				border: none;
			}
			
			#tab-hand-over-content tbody tr td a,
			#tab-hand-over-content tbody tr td a:hover,
			#tab-hand-over-content tbody tr td a:focus {
				color: red;
				text-decoration: none;
				cursor: pointer;
			}
			
			#tab-hand-over-content tr td ul {
				height: 100%;
				width: 100%;
			}
			
			#tab-hand-over-content tr td ul li {
				width: 100%;
			}
			
			#tab-hand-over-content tbody tr td ul li {
				width: 100%;
				border-bottom: 1px dashed #eee;
				height: 35px;
			}
			
			#tab-hand-over-content tbody tr td ul li:last-child {
				border-bottom: none;
			}
			
			#tab-hand-over-content tr td ul li div div:first-child {
				width: 80%;
				border-right: 1px solid #eee;
			}
			
			#tab-hand-over-content tr td ul li div div:last-child {
				width: 20%;
			}
			
			#tab-hand-over-content tr td:first-child {
				padding-left: 14px;
			}
			
			#tab-hand-over-content tr td ul li div div {
				padding: 10px 0 14px 0;
				padding-left: 14px;
				text-align: left;
			}
			
			/*处理客户新样式*/
			.apple-list-menu {
				font-size: 12px;
				color: #666;
			}
			
			.apple-list-menu span[bind] {
				display: inline-block;
				margin: 0 17px 0 10px;
			}
			
			.apple-list-menu .info-title {
				font-size: 18px;
				color: #333;
			}
			
			.apple-list-menu .record>div {
				margin-right: 30px;
				text-align: center;
			}
			
			.type-num-red {
				font-size: 18px;
				color: #CA192B;
			}
			
			.apple-list-additioninfo {
				height: 82px;
				line-height: 20px;
				padding: 10px 0;
				border-radius: 0;
			}
			
			.apple-list-additioninfo>div {
				width: 33%;
				text-align: center;
			}
			
			.apple-list-additioninfo>div span {
				font-size: 14px;
				color: #333;
			}
			
			.apple-list-additioninfo>div .note-font-type {
				font-size: 12px;
				color: #999;
			}
			
			.apple-list-additioninfo>div .right-line {
				display: block;
				height: 20px;
				border-right: 1px solid #e3e3e3;
			}
			
			.item-footer .color-gray {
				color: #666;
			}
			
			.item-footer .color-gray .text-danger {
				color: #ca192b;
			}
			
			.apple-list-additioninfo>div:last-child .right-line {
				display: block;
				height: 20px;
				border: 0;
			}
			
			.apple-list-box img {
				width: 40px;
				height: 40px;
				border: 1px solid #eee;
				border-radius: 0;
			}
			
			.apple-list-box .apple-list-box-top {
				height: 60px;
				padding: 10px 20px 8px 14px;
				border: 0;
			}
			
			.apple-list-box .apple-list-box-top>div {
				margin-left: 10px;
			}
			
			.apple-list-box-middle {
				min-height: 36px;
				line-height: 36px;
				background-color: #f8f8f8;
				padding: 0 20px 0 10px;
				font-size: 14px;
				color: #999;
			}
			
			.apple-list-box-middle span:first-child {
				color: #CA192B;
			}
			
			.month-sale-num {
				float: right;
				font-size: 14px;
				color: #666;
			}
			
			.month-sale-num span {
				color: #CA192B;
				font-size: 18px;
			}
			
			.apple-list-box.clickstyle {
				background: #fff;
				border: 1px solid #CA192B;
			}
			
			.apple-list-box-bottom .btn {
				margin: 8px 10px;
			}
			
			.rob-main .rob-list {
				font-size: 14px;
				color: #999;
				max-width: 270px;
				display: block;
			}
			.rob-commitment .rob-list{
				width: 260px;
				max-width: 260px;
			}
			.rob-list {
				font-size: 14px;
				color: #666;
				padding-left: 14px;
				padding-right: 14px;
			}
			
			.rob-plan .rob-list {
				color: #999;
				font-size: 12px;
				background-color: #fff;
			}
			
			.sale-surpose {
				color: #CA192B;
			}
			
			.list-box-txt {
				
			}
			
			.group-handle {
				margin-left: 10px;
				cursor: pointer;
				position: relative;
				background-image: url(../resources/images/add-group-icon.png);
				display: inline-block;
				width: 21px;
				height: 18px;
			}
			
			.btn-wait-handle {
				width: 80px!important;
			}
			
			.movepubilc-info .search .form-inline.first-form-inline .form-control-search {
				margin-left: 0;
			}
			
			.movepubilc-info .search .form-inline.first-form-inline .form-control-search {
				margin-left: 0;
			}
			
			.movepubilc-info .search .form-crumb .groups .breadcrumb .item input[type='checkbox'],
			.movepubilc-info .search .form-crumb .groups .breadcrumb .item input[type='checkbox'] {
				margin: 0;
			}
			
			.movepubilc-info .ui-jqgrid .ui-jqgrid-view input,
			.movepubilc-info .ui-jqgrid .ui-jqgrid-view input {
				margin: 0;
			}
			
			.ui-jqgrid {
				border-bottom: 1px solid #e3e3e3;
			}
		</style>
	</head>

	<body>
		<div class="page-container crm-client-public page-crm-sea">
			<!--<div class="content">
				<div class="remark">
					<img src="../resources/images/public-sea-icon.png" alt="" /><span>*公海客户是公共资源，可以自行争取客户的所有权</span>
				</div>
			</div>-->
			<div class="content-main">
				<div class="content-main-left pull-left">
					<ul class="menu-top tree">
					</ul>
					<div class="fotter-btn-container">
						<a class="content-main-left-link btn btn-info def-btn-info" role-auth1="saas/crm/customer/transfer|post" onclick="handOverClient()">
							<img src="../resources/images/into-sea-icon.png" alt="" />移入公海
						</a>
					</div>
				</div>
				<div class="content-main-right">
					<div class="content-main-right-list">

					</div>
					<!--<div class="client-pubilc-page">
						<div class="public-page page-befor">
							<i style="color: #999;display: inline-block;margin-right: 8px;" class="fa fa-fast-backward fa-x"></i>
							<i style="color: #999;display: inline-block;margin-right: 4px;" class="fa fa-backward fa-x"></i>
						</div>
						<div class="public-page page-row" style="border-left: 2px solid #ccc;border-right: 2px solid #ccc;padding: 0 5px;">第
							<input type="text" class="history-curr-pager" maxlength="3" value="1" ime-mode: "disabled" onkeydown="if(event.keyCode==13)event.keyCode=9" onKeypress="if((event.keyCode<48 || event.keyCode>57)) event.returnValue=false">/
							<span class="history-total-pager"></span>页，
							<span class="history-total-record"></span>条
						</div>
						<div class="public-page page-after">
							<i style="color: #999;display: inline-block;margin-left: 4px;" class="fa fa-forward fa-x"></i>
							<i style="color: #999;display: inline-block;margin-left: 8px;" class="fa fa-fast-forward fa-x"></i>
							<i class="fa fa-refresh" style="color: #999;display: inline-block;margin-left: 4px;" aria-hidden="true"></i>
						</div>
					</div>-->
				</div>
			</div>
		</div>
		<!--移入公海弹窗-->
		<div class="movepubilc hide">
			<p>请选择需要移入公海的客户：</p>

			<div class="movepubilc-info">
				<div class="search">

				</div>
				<div class="my-client-list">
					<table class="movepubilc-tab">

					</table>
				</div>
			</div>
			<div class="movepubilc-btn">
				<input type="button" class="btn btn-default" onclick="handOverClient()" value="下一步" />
				<input type="button" name="" id="" value="取消" class="btn btn-default movepubilc-btn-off" data-dismiss="modal" />
			</div>
		</div>
		<!--模板-->
		<div class="hand-over-client-panel hide">
			<!--第一步选择移交内容-->
			<div class="steps-panel step-1">
				<p>请选择需要移入的客户：</p>

				<div class="movepubilc-info">
					<div class="search">

					</div>
					<div class="my-client-list">
						<table class="movepubilc-tab">

						</table>
						<div class="grid-pager">
						</div>
					</div>
				</div>
				<!--<div class="movepubilc-btn">
				<input type="button" class="btn btn-default" onclick="handOverClient()" value="下一步" />
				<input type="button" name="" id="" value="取消" class="btn btn-default movepubilc-btn-off" data-dismiss="modal" />
			</div>-->
			</div>
			<!--第二步选择移交内容-->
			<div class="content-left steps-panel step-2 hide">
				<!--移交内容title-->
				<div class="content-left-companys-container">
					<label>请选择需要移入的单位</label>
					<div class="content-left-companys">
						
					</div>
				</div>
				<!--移交的具体内容-->
				<div class="content-left-body">
					<!--移交的内容title   客户单位  科室/部门 -->
					<label>选择单位即包含其科室/部门及联系人，选择科室/部门即包含其联系人</label>
					<div class="one-client-detail"></div>
				</div>
			</div>
			<!--第二部：已选择移交的内容-->
			<div class="content-right steps-panel step-3 hide">
				<!--<span class="content-right-title">已选择移交的内容：</span>-->
				<!--移交内容表格-->
				<div>
					<table id="tab-hand-over-content">
						<thead>
							<tr>
								<td style="width:25%;">移入内容</td>
								<td>
									<ul class="">
										<li class="at">
											<div class='item'>
												<div class="lt">移入内容</div>
												<div class="lt">操作</div>
											</div>
											
										</li>
									</ul>
								</td>
							</tr>
						</thead>
						<tbody>
							
						</tbody>
					</table>
				</div>
			</div>
			<!--第三步：选择接收对象、填写移交原因-->
			<div class="hand-over-object-reason steps-panel step-4 hide">
				<!--选择接收对象-->
				<div class="sel-accept-object form-inline">
					<label class="input-flag">移入范围：</label>
					<div class="receive-obj-container">
						<span class="note-font-type form-control no-tip">请选择接移入范围</span>
						<span class="selected-container form-control hide"></span>
						<a href="javascript:;" class="btn-sel-accept-object btn-a-default">选择部门</a>
					</div>
				</div>
				<!--移交原因-->
				<div class="hand-over-reason form-inline">
					<label class="input-flag">移入原因：</label>
					<textarea cols="70" class="form-control" rows="4" nulltip="移入原因"></textarea>
				</div>
			</div>
			<hr style="margin: 0;border: 0;" />
			<!--底部按钮-->
			<div class="hand-over-foot-btn">
				<a href="javascript:;" class="btn btn-info def-btn-info prev-step" data-curr-step="1">上一步</a>
				<a href="javascript:;" class="btn btn-danger def-btn-danger next-step" data-curr-step="1">下一步</a>
				<a href="javascript:;" class="btn btn-primary def-btn-primary cancel-hand-over" data-curr-step="1">取消</a>
			</div>
		</div>
		<!--客户信息弹窗-->
		<div class="client-information hide">
			<div class="client-info-top">
				<p class="client-info-top-menu">
					<span class="info-name" bind="client_full_name"></span>
					<span class="note-font-type area-cn" bind="client_administrative_division_cn"></span>
					<span class="group-handle"></span>
					<br />
					<span class="data-name">客户类型</span>
					<span class="info-type data-detail" bind="client_type_cn"></span>
					<span class="data-name">资质</span>
					<span class="data-detail" bind="client_level_cn"></span>
					<span class="data-name">客户等级</span>
					<span class="info-state data-detail" bind="client_important_level_cn"></span>
				</p>
				<div class="client-info-top-tab at">
					<div class="lt">
						<span class="">门诊量</span>
						<i class="right-line"></i>
						<span class="" bind="client_outpatients_count">0</span>
					</div>
					<div class="lt">
						<span>床位数</span>
						<i class="right-line"></i>
						<span class="" bind="client_sickbeds_count">0</span>
					</div>
					<div class="lt">
						<span class="">年销量（万元）</span>
						<i class="right-line"></i>
						<span bind="annual_sale_count">0</span>
					</div>
					<div class="lt">
						<span>最近拜访数</span>
						<i class="right-line"></i>
						<span bind="recent_visit_count">0</span>
					</div>
				</div>
			</div>
			<div class="client-info-bottom">
				<ul class="movepubilc-nav">
					<li>部门</li>
					<li>联系人</li>
				</ul>
				<div class="client-info-tab">
					<table class="client-deparyinfo-tabs">
					</table>
					<table class="client-linkmaninfo-tabs">
					</table>
				</div>
			</div>
			<!--<a name="" class="btn btn-primary def-btn-primary btn-sm client-info-offbtn" data-dismiss="modal">关闭</a>-->
		</div>
		<!--抢客户弹窗-->
		<div class="rob-client-container hide">
			<div class="rob-client at">
				<div class="rob-client-left step-panel step-panel-1 lt">
					<p>请选择您要抢取的客户</p>
					<ul class="department-tree">
	
					</ul>
				</div>
				<div class="rob-client-right step-panel step-panel-2 lt hide">
					<form class="form-inline form-horizontal">
						<div class="form-group form-inline">
							<label class="input-flag">抢取宣言：</label>
							<input type="text" class="rob-client-right-main form-control txt-manifesto" bind="request_a_word_declaration" placeholder="请用一句话说明您的抢取宣言" />
						</div>
						<div class="form-group form-inline-sale form-inline at">
							<label class="input-flag lt">销售承诺：</label>
							<div class="rob-client-right-main lt">
								<p>我承诺在第 1 个月，销量达到<input type="text" bind="request_sales_commitment_month1" maxlength="10" onkeyup="value=value.replace(/[^\d.]/g,'')" />万元</p>
								<p>我承诺在第 3 个月，销量达到<input type="text" bind="request_sales_commitment_month3" maxlength="10" onkeyup="value=value.replace(/[^\d.]/g,'')" />万元</p>
								<p>我承诺在第 6 个月，销量达到<input type="text" bind="request_sales_commitment_month6" maxlength="10" onkeyup="value=value.replace(/[^\d.]/g,'')" />万元</p>
							</div>
						</div>
						<div class="form-group form-inline">
							<label class="input-flag">销售计划：</label>
							<textarea bind="request_sales_plans" class="rob-client-right-main form-control" placeholder=""></textarea>
						</div>
					</form>
				</div>
				<div class="rob-client-fotter-btns">
					<a class="btn def-btn-danger btn-danger btn-next-step">下一步</a>
					<a class="btn btn-danger def-btn-danger btn-ok hide">确定</a>
					<a class="btn btn-primary def-btn-primary btn-cancel">取消</a>
				</div>
			</div>
		</div>
		<!--申请列表弹窗-->
		<div class="apple-list hide">
			<div class="apple-list-menu">
				<p class="lt">
					<span class="info-title" bind="client_profile.client_full_name"></span>
					<br />
					<span class="note-font-type">客户类型</span>
					<span class="info-type" bind="client_profile.client_type_cn"></span>
					<span class="note-font-type">资质</span>
					<span class="info-unitsgrade" bind="client_profile.client_level_cn"></span>
					<span class="note-font-type">重要等级</span>
					<span class="info-clientgrade" bind="client_profile.client_important_level_cn"></span>
					<!--<i class="fa fa-users" aria-hidden="true" style="margin-left: 10px;cursor: pointer;position: relative;"></i>-->
				</p>
				<div class="record rt at">
					<div class="lt">
						<span class="type-num-red" bind="client_profile.request_num"></span>
						<p class="note-font-type">抢取人数</p>
					</div>
					<div class="lt">
						<span class="type-num-red" bind="client_profile.view_num"></span>
						<p class="note-font-type">查看人数</p>
					</div>
				</div>
				<div class="clearfix"></div>
			</div>
			<div class="apple-list-additioninfo at">
				<div class="lt">
					<span class="note-font-type">
						部门/科室数量
					</span>
					<i class="right-line"></i>
					<span class="" bind="client_profile.total_department"></span>
				</div>
				<div class="lt">
					<span class="note-font-type">
						联系人数量
					</span>
					<i class="right-line"></i>
					<span class="" bind="client_profile.total_contact"></span>
				</div>
				<div class="lt">
					<span class="note-font-type">
						年销量（元）
					</span>
					<i class="right-line"></i>
					<span class="" bind="">未知</span>
				</div>
			</div>
			<div class="apple-list-main at">
				<div class="apple-list-main-left rt">
					<div class="rob-commitment">
						<p class="rob-menu">销售承诺</p>

					</div>
					<div class="rob-main">
						<p class="rob-menu">抢取内容</p>
						<!--<p class="client-name">重庆市西南医院</p>
						<p class="clientdepart-name">神经内科，呼吸科</p>
						<p class="">耳鼻喉科>张三，李四</p>
						<p class="">眼科>王五</p>-->
					</div>
					<div class="rob-plan">
						<p class="rob-menu">销售计划</p>

					</div>
				</div>
				<div class="apple-list-main-right lt">

				</div>
			</div>
			<!--<div class="apple-list-bottom">
				移入时间：<span bind="client_profile.put_into_date">2016-06-12 09:00</span>
			</div>-->
		</div>
		<!--选择范围弹窗-->
		<div class="select-scope hide">
			<p>请选择公海范围：</p>
			<ul class="select-scope-deparmenttree">
			</ul>
		</div>
		<!--同意员工申请页面弹窗-->
		<div class="applyfor hide">
			<p>确认同意该员工的申请？</p>
		</div>
	</body>
	<script type="text/javascript" src="../resources/js/jquery.min.js"></script>
	<script type="text/javascript" src="../resources/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="../resources/js/jquery.gritter.min.js"></script>
	<script type="text/javascript" src="../resources/js/jquery.jqGrid.min.js"></script>
	<script type="text/javascript" src="../resources/js/grid.locale-zh.js"></script>
	<script type="text/javascript" src="../resources/kindeditor/kindeditor-min.js"></script>
	<script type="text/javascript" src="../resources/kindeditor/zh-CN.js"></script>
	<script type="text/javascript" src="../resources/upload/plupload.full.min.js"></script>
	<script type="text/javascript" src="../resources/js/bootstrap-datepicker.min.js"></script>
	<script type="text/javascript" src="../resources/js/main.min.js"></script>
	<script type="text/javascript" src="../resources/js/customize/hgf.js"></script>
	<script type="text/javascript" src="../resources/js/customize/IM.js"></script>
	<script type="text/javascript" src="../resources/js/customize/hxj.js"></script>
	<script type="text/javascript">
		//------------消息队列相关   订阅者-----------------------
		var subscriber = parent.HHMQ.createSubscriber('公海', 'business_notify', function(flag, msgData) {
			if(flag == "welcome") {
				$.showSuccessGritter(JSON.stringify(msgData), {
					clear: false
				});
			}
			//收到审批处理消息
			if(msgData.action == "refresh") {
				//认证通过
				if(APV_ROUTINE_IDS.crm[msgData.routin_id]) {
					if(infoGrid) $(infoGrid).reloadGrid();
				}
			}
		});
		//页面关闭事件
		context.onPageClose = function() {
			subscriber.dispose();
		};
		//------------消息队列相关   订阅者end -------------------
		var infoGrid, clientDeparInfoGrid, clientLinkmanInfoGrid, selectClientPage;
		var infoUrlForAdd = BSAPIURL + "/crm/customers";
		var departmentUrl = BSAPIURL + "/company/depas?mode=2&with_my_depa=1";
		var departmentAllUrl = BSAPIURL + "/company/depas?mode=1";
		var clientPackageListUrl = BSAPIURL + "/crm_seas_manage/query_sea_customers";
		var mySubordinateClientUrl = BSAPIURL + "/crm_seas_manage/subordinate_consumer";
		var myClientUrl = BSAPIURL + "/crm/customers?data_scope=2";
		var robClientUrl = BSAPIURL + "/crm_seas_manage/pickup_employees";
		var packageApplyForListUrl = BSAPIURL + "/crm_seas_manage/pickup_list_detail";
		var immigrationPublicUrl = BSAPIURL + "/crm_seas_manage/resources";
		var robClientApplyforUrl = BSAPIURL + "/crm_seas_manage/handle_pickup";
		//var companyDerpatTreeUrl = BSAPIURL + "/company/depas?mode=1";
		var selectScopeDeparmentTreeData, clientInfoData;
		//表格对象
		var clientDeparInfoTab, clientLinkmanInfoTab;
		var disposeClientInfoData;
		var applyforListClientId, applyforListpackId, applyforListPlace;
		var pageNum = 1,
			searchDeparId, lastPageNum;
		var publicClientState = {
			approve: 1,
			new_pack: 2,
			can_receive: 3,
			sell_out: 4
		}
		var inScrollLoading=false;
		$(".content-main-left").css("height", $(window).height() + "px");
		$(".content-main-left .tree").css("height", $(window).height() - 100 + "px");
		$(".content-main-right") /*.css("width",$(window).width()-210+"px")*/ .css("height", $(window).height() - 15 + "px");
		$(".content-main-right-list").css("height", $(window).height() - 45 + "px").css("overflow-y", "auto")
		.css("width",$(window).width()-215+"px");
		$(".client-pubilc-page,.content-main-right").css("width",$(window).width()-215+"px");
		$(function() {
			//获取左侧部门树数据
			loadDashedDeptTree({
				container: ".menu-top",
				url: departmentUrl,
				showIcon: true,
				onlyShowDept: true,
				childDepaKey: "departments",
				depaIdKey: "depa_id",
				showEmps: true,
				parentDepaIdKey: "depa_parent_id",
				removeHeightForTree: $(".fotter-btn-container").outerHeight(true) + 10,
				loadComplete: function() {
					$(".menu-top label").click(function() {
						loadClientPackageList(true,$(this).attr("code"), 1);
					});
				}
			});
			
			//加载公海列表
			loadClientPackageList(true,"", pageNum);

			
			//滚动加载
			//滚动加载
			$(".content-main-right-list").scroll(function() {
				if(inScrollLoading) return;
				var boolIsToBottom = $(this).scrollTop()>=($(this).get(0).scrollHeight-$(this).height());
				//判断鼠标向上滚动，显示出来
				if(boolIsToBottom) {
					inScrollLoading=true;
					pageNum ++;
					searchDeparId = "";
					loadClientPackageList(false,searchDeparId, pageNum);
				}
			});
		});
		//加载左侧部门树
		function loadLeftDepaTree(parentId, treeData) {
			for(var i in treeData) {
				var str = "<li data-depar-id=" + treeData[i].depa_id + ">";
				str += "<div class='menu-title'>";
				str += "<i class='fa fa-minus-square-o' aria-hidden='true' onclick='treeUpDown(this)'></i>";
				str += "<span class='' onclick=\"loadClientPackageList('true','" + treeData[i].depa_id + "',1)\">" + treeData[i].depa_name + "</span>";
				str += "</div>";
				str += "<ul>";
				str += "</ul>";
				str += "</li>";
				if(parentId == "") {
					$(".menu-top").append(str);
				} else {
					$(".menu-top li[data-depar-id=" + parentId + "]>ul").append(str);
				}
				if(treeData[i].departments) {
					loadLeftDepaTree(treeData[i].depa_id, treeData[i].departments);
				}
			}
		}
		//加载客户公海包列表
		function loadClientPackageList(needEmpty,depaId, page) {
			searchDeparId = depaId;
			//清空
			if(needEmpty!="false"&&needEmpty)$(".content-main-right-list").empty();
			//获取客户列表信息
			$.ajaxGet(clientPackageListUrl + "?depa_id=" + depaId + "&page=" + page, function(response) {
				var clientListInfo = response.data.rows;
				if(clientListInfo.length<1) {
					pageNum--;
					$.showSuccessGritter("已经全部加载完！");
					inScrollLoading=false;
					return;
				}
				//分页信息
				$(".history-total-pager").text(response.data.total);
				$(".history-total-record").text(response.data.records);
				lastPageNum = response.data.total
				for(var i in clientListInfo) {

					var flagHtml = "";
					var statusLabelClass = "label-default";
					switch(parseInt(clientListInfo[i].package_status)) {
						case 1:
							statusLabelClass = "label-default";
							break;
						case 2:
							statusLabelClass = "label-success";
							break;
						case 3:
							statusLabelClass = "label-info";
							break;
						default:
							statusLabelClass = "label-danger";
							break;
					}
					if(i == 0) {
						flagHtml = "<span class=\"text-danger font-blod\">hot</span>";
					}

					var itemHml = "<div class=\"sea-client-item list-box\" onclick='clientInfo(event,this)' id='" + clientListInfo[i].package_id + "' data-clientid='" + clientListInfo[i].package_data_client_id + "'>" +
						"							<div class=\"item-header\">" +
						"								<div class=\"clearfix\">" +
						"									<div class=\"left\">" +
						"										<span class=\"color-black font-size-16 font-blod css-overhidden\" title='" + clientListInfo[i].client_full_name + "'>" + clientListInfo[i].client_full_name + "</span> <span class=\"color-gray\">（" + clientListInfo[i].client_administrative_division_cn + "）</span> " +
						"                                        " + flagHtml +
						"									</div>" +
						"									<div class=\"right\">" +
						"										<span class=\"label " + statusLabelClass + "\">" + clientListInfo[i].package_status_cn + "</span>" +
						"									</div>" +
						"								</div>" +
						"								<div class=\"clearfix mata\">" +
						"									<div class=\"left\">" +
						"										<span class=\"lab color-gray\">客户类型 <span class=\"color-gray-black\">" + clientListInfo[i].client_type_cn + "</span></span>" +
						"										<span class=\"lab color-gray\">资质 <span class=\"color-gray-black\">" + clientListInfo[i].client_level_cn + "</span></span>" +
						"										<span class=\"lab color-gray\">等级 <span class=\"color-gray-black\">" + clientListInfo[i].client_important_level_cn + "</span></span>" +
						"									</div>" +
						"									<div class=\"right\">" +
						"										<span class=\"color-gray\">移入时间：" + clientListInfo[i].put_into_date + "</span>" +
						"									</div>" +
						"								</div>" +
						"							</div>" +
						"							<div class=\"item-wrap\">" +
						"								<table class=\"table-count\" border=\"0\" width=\"100%\">" +
						"									<tr>" +
						"										<th>科室/部门</th>" +
						"										<th>联系人</th>" +
						"										<th>年销量</th>" +
						"									</tr>" +
						"									<tr>" +
						"										<td>" + clientListInfo[i].total_department + "个</td>" +
						"										<td>" + clientListInfo[i].total_contact + "个</td>" +
						"										<td>" + clientListInfo[i].annual_sale_count + "元</td>" +
						"									</tr>" +
						"								</table>" +
						"							</div>" +
						"							<div class=\"item-footer\">" +
						"								<div class=\"clearfix\">" +
						"									<div class=\"left\">" +
						"										<span class=\"lb color-gray\">抢取人数 <span class=\"text-danger\">(" + clientListInfo[i].request_num + ")</span></span>" +
						"										<span class=\"lb color-gray\">查看人数 <span class=\"text-danger\">(" + clientListInfo[i].view_num + ")</span></span>" +
						"									</div>" +
						"									<div class=\"right\">" +
						((clientListInfo[i].package_status != 1 && clientListInfo[i].can_pick) ? "<button type=\"button\" class=\"btn btn-sm btn-info def-btn-info\" onclick='robClient(event,this)'> 我要抢 </button> " : "") +
						((clientListInfo[i].package_status != 1 && clientListInfo[i].can_handle) ? "<button type=\"button\" class=\"btn btn-sm btn-danger btn-wait-handle def-btn-danger\" onclick='dispose(event,this," + clientListInfo[i].request_num + "," + clientListInfo[i].can_handle + ")'> 待我处理(" + clientListInfo[i].need_handle_num + ")</button> " : "") +
						"									</div>" +
						"								</div>" +
						"							</div>" +
						"						</div>";

					$(".content-main-right-list").append(itemHml);
					$("#" + clientListInfo[i].package_id).data("state", clientListInfo[i].package_status);
					continue;

					var str = "<div class='list-box' onclick='clientInfo(event,this)' id='" + clientListInfo[i].package_id + "' data-clientid='" + clientListInfo[i].package_data_client_id + "'>";
					str += "<div class='list-box-top'>";
					str += "<div class='list-box-top-info pull-left'>";
					str += "<div class=''>";
					str += "<span class='box-top-name'>" + clientListInfo[i].client_full_name + "</span>";
					str += "<span class='box-top-type'>" + clientListInfo[i].client_type_cn + "</span>";
					str += "<span class='box-top-clientgrade'>" + clientListInfo[i].client_important_level_cn + "客户</span>";
					str += "<span class='box-top-hospitalgrade'>" + clientListInfo[i].client_level_cn + "</span>";
					str += "</div>";
					str += "<p class='hospitalregion'>";
					str += "<span class='province'>" + clientListInfo[i].client_administrative_division_cn + "</span>";
					//str += "<span class='city'>"+clientListInfo[i].client_full_name+"</span>，";
					//str += "<span class='area'>"+clientListInfo[i].client_full_name+"</span>";
					str += "</p>";
					str += "</div>";
					str += "<div class='box-top-state pull-left' onclick=\"noClick(this)\">";
					if(clientListInfo[i].package_status != 1) {
						str += "<div class='record'>";
						str += "<img src='../resources/images/applyfor.png' /><span>" + clientListInfo[i].request_num + "</span>";
						str += "<img src='../resources/images/view.png' /><span>" + clientListInfo[i].view_num + "</span>";
						str += "</div>";
					}
					str += clientState(clientListInfo[i].package_status);

					str += "</div>";
					str += "<div class='clearfix'></div>";
					str += "</div>";
					str += "<div class='list-box-main'>";
					str += "<div class='box-main-left pull-left'>";
					str += "<p class='box-main-departmentnum'><span class='box-main-name'>部门/科室</span><span class='box-main-num'>" + clientListInfo[i].total_department + "</span></p>";
					str += "<p class='box-main-linkmannum'><span class='box-main-name'>联系人</span><span class='box-main-num'>" + clientListInfo[i].total_contact + "</span></p>";
					str += "<p class='box-main-yearsalesvolume'><span class='box-main-name'>年销量(元)</span><span class='box-main-num'>暂缺</span></p>";
					str += "</div>";

					str += "<div class='box-main-right pull-left'>";
					if(clientListInfo[i].package_status != 1) {
						if(clientListInfo[i].can_pick) {
							str += "<div class='box-main-right-rob' onclick='robClient(event,this)'>";
							str += "<a href='javascript:;'><i class='fa fa-hand-paper-o' aria-hidden='true'></i>抢客户</a>";
							str += "</div>";
						}

						if(clientListInfo[i].can_handle) {
							str += "<div class='box-main-right-dispose' onclick='dispose(event,this," + clientListInfo[i].request_num + "," + clientListInfo[i].can_handle + ")'>";
							str += "<a href='javascript:;'><i class='fa fa-pencil-square-o' aria-hidden='true'></i>处理</a>";
							if(clientListInfo[i].need_handle_num != "0") {
								str += "<span class='disposenum'>" + clientListInfo[i].need_handle_num + "</span>";
							}
							str += "</div>";
						}
					}
					str += "</div>";
					str += "<div class='clearfix'></div>";
					str += "</div>";
					str += "<div class='list-box-bottom'>";
					str += "<p class='box-time'>移入时间：<span>" + clientListInfo[i].put_into_date + "</span></p>";
					str += "</div>";
					if($(".content-main-right-list>div").length == 0) {
						str += "<img src='../resources/images/hot.png' class='hot' />";
					}
					str += "</div>";
					$(".content-main-right-list").append(str);
					$("#" + clientListInfo[i].package_id).data("state", clientListInfo[i].package_status)
				}
				inScrollLoading=false;
			});
		}

		////移交客户
		var handOverClientModalId = "";

		function handOverClient() {
			handOverClientModalId = $.modal({
				showFooter: false,
				height: 610,
				width: $("body").outerHeight(true) - 100
			}).show("移入公海", ".hand-over-client-panel", function(modal) {});
			$("#" + handOverClientModalId).on('shown.bs.modal', function() {
				$("#" + handOverClientModalId + " .movepubilc-tab").attr("id", "movepubilc-tab");
				$.initSearchControls4TagMode({
					auto: true,
					url: myClientUrl,
					grid: "#movepubilc-tab",
					container: "#" + handOverClientModalId + " .search",
					key_name: "key",
					removeHeight4Grid: $("#" + handOverClientModalId + " .modal-body .search").outerHeight(true) + 300,
					key_placeholder: "请输入客户单位名称进行查找",
					onChange: function(selectTags) {},
					groups: [{
						name: "employee_scope",
						text: "客户范围",
						items: [{
							key: "全部客户",
							value: "1,2"
						}, {
							key: "我的客户",
							value: "1"
						}, {
							key: "我的下属客户",
							value: "2"
						}]
					}]
				});
				$("#" + handOverClientModalId + " .grid-pager").attr("id", "grid-pager");
				var place = "#movepubilc-tab";
				var gridHeight = $("#" + handOverClientModalId + " .modal-body").outerHeight(true) - $("#" + handOverClientModalId + " .modal-body .search").outerHeight(true) - 240;
				var colNames = ['', '客户单位名称', '客户类型', '重要等级', '资质等级', '部门/科室、联系人数量', '地址', '负责人'];
				var colModel = [{
					name: 'client_id',
					index: 'client_id',
					hidden: true
				}, {
					name: 'client_full_name'
				}, {
					name: 'client_type_cn'
				}, {
					name: 'client_important_level_cn'
				}, {
					name: 'client_level_cn'
				}, {
					name: '__information_type_cn',
					formatter: function(cellvalue, options, rowObject) {
						try {
							return rowObject.department_count + "," + rowObject.contact_count;
						} catch(e) {
							return '';
						}
					}
				}, {
					name: 'client_addr'

				}, {
					name: 'responsible_employee_name',
					index: 'responsible_employee_name',
					formatter: function(cellvalue, options, rowObject) {
						var responsiblePersonNameArr = [];
						for(var i in rowObject.responsible_person_data) {
							responsiblePersonNameArr.push(rowObject.responsible_person_data[i].employee_name);
						}
						return responsiblePersonNameArr.join(",");
					}
				}];
				infoGrid = $(place).initJqGrid({
					grid_selector: place,
					url: myClientUrl + "&employee_scope=1,2",
					pager: "#grid-pager",
					colNames: colNames,
					colModel: colModel,
					rowNum: 10,
					height: gridHeight,
					storeRowDataInCache: true,
					storageIdName: "client_id",
					afterLoadComplete: function() {}
				});
			});
			var ids = '';
			var postData = [];
			var pulicePostData = [];
			var len = '';

			//上一步
			$("#" + handOverClientModalId + " .prev-step").click(function() {
				var stepNum = $(this).attr("data-curr-step");
				var prevStepNum = parseInt(stepNum) - 1;
				if(prevStepNum == 0) {
					$.showErrorGritter("当前已经是第一页！");
					return false;
				}
				$("#" + handOverClientModalId + " .steps-panel").addClass("hide");
				$("#" + handOverClientModalId + " .step-" + prevStepNum).removeClass("hide");
				transCurrStepNum(prevStepNum);
			});
			//下一步
			$("#" + handOverClientModalId + " .next-step").click(function() {
				var stepNum = $(this).attr("data-curr-step");
				if(stepNum == 4) {
					var transferTargetID = $("#" + handOverClientModalId + " .selected-container span").attr("data-id");
					if(!transferTargetID) {
						$.showErrorGritter("移入范围不能为空！");
						return false;
					}
					var handOverReason = $("#" + handOverClientModalId + " .hand-over-reason textarea").val();
					if(!handOverReason) {
						$.showErrorGritter("移入原因不能为空！");
						return false;
					}

					if(inputValidateForGritter("#" + handOverClientModalId + " .content-right")) {
						////////console.log(selectedEmployeeIds);
						$.showApprovalPostPop({
							routine: "clientTransferToSea",
							routineName: "移入公海",
							successCallback: function(apvData, apvModal) {
								if(apvData.needApv) {
									apvData.diy_step_data = apvData.steps;
									apvData.plan_id = apvData.planId;
								}
								var tempPulicePostData = getIntoSeaData(handOverClientModalId);
								var pulicePostData=[];
								pulicePostData=pulicePostData.concat(tempPulicePostData.client);
								pulicePostData=pulicePostData.concat(tempPulicePostData.depa);
								pulicePostData=pulicePostData.concat(tempPulicePostData.contact);
								if(!pulicePostData.length) return false;
								apvData.transfer_data = pulicePostData;
								apvData.scope_id = transferTargetID;
								apvData.put_into_note = handOverReason;
								$.ajaxPost(immigrationPublicUrl, apvData,
									function(resp) {
										if(resp.code == 0) {
											$.showSuccessGritter(apvData.needApv ? "移入公海提交成功，请等待审批！" : "移入公海成功！");
											$("#" + handOverClientModalId).modal('hide');
											//apvModal.modal('hide');
											apvModal && apvModal.modal("hide");
											//刷新公海列表
											loadClientPackageList(true,'','');
										} else {
											$.showErrorGritter("移入公海失败：" + resp.msg);
										}
									})
								////console.log(handOverReason);

							}
						});
					}
					return false;
				} else if(stepNum == 1) {
					//ids = $().getSelectRowIdsForjqGrid("id");
					var selectedRowDatas = $(infoGrid).getRowData4JqGrid("", "", true);
					
					console.log(selectedRowDatas)
					if(selectedRowDatas.length < 1) {
						$.showErrorGritter("请先选择客户单位！");
						return false;
					}
					if(!boolCanClickBtn(selectedRowDatas, "into_sea")) return false;;
					var clientIds = [];
					for(var i in selectedRowDatas) {
						clientIds.push(selectedRowDatas[i].client_id);
					}
					len = clientIds.length;
					$.showLoadingPop("正在加载客户数据，请稍候...");
					$.ajaxGet(BSAPIURL + "/crm/responsible_tree?check_permissions=into_sea&clients=" + clientIds + "&with_lower=1", function(resp) {
						$.hideLoadingPop();
						handOverClientLeftFill(resp.data);
					});
				} else if(stepNum == 2) {
					console.log(getIntoSeaData(false,handOverClientModalId))
					if(!getIntoSeaData(false,handOverClientModalId)) return false;
					writeTable();
				} else if(stepNum == 3) {
					if($("#" + handOverClientModalId + " .step-3 table tr").length == 1) {
						$.showErrorGritter("移入资源不能为空，请重新选择移入资源！");
						return false;
					}
				}
				var nextStepNum = parseInt(stepNum) + 1;
				$("#" + handOverClientModalId + " .steps-panel").addClass("hide");
				$("#" + handOverClientModalId + " .step-" + nextStepNum).removeClass("hide");
				transCurrStepNum(nextStepNum);
			});
			
			//负责改变当前步数属性值和按钮文本
			function transCurrStepNum(num) {
				$("#" + handOverClientModalId + " .hand-over-foot-btn a").each(function() {
					$(this).attr("data-curr-step", num);
					if(num == 4) {
						$("#" + handOverClientModalId + " .next-step").text("完成");
					} else {
						$("#" + handOverClientModalId + " .next-step").text("下一步");
					}
				});
			}
			//取消
			$("#" + handOverClientModalId + " .cancel-hand-over").click(function() {
				$("#" + handOverClientModalId).modal('hide');
			});
			function handOverClientLeftFill(clients) {
				$("#" + handOverClientModalId + " .content-left-companys").empty();
				$("#"+handOverClientModalId+" .one-client-detail").empty();
				for(var i in clients) { //第一层遍历医院
					var companySpanDom=$("<span data-client-id='{ID}' class='client-name'>{NAME}</span>");
					companySpanDom.data("client-data",clients[i])
						.attr("data-client-id",clients[i].client_id)
						.attr("data-client-name",clients[i].client_full_name)
						.text(clients[i].client_full_name);
					if(i==0) companySpanDom.addClass("active");
					$("#"+handOverClientModalId+" .content-left-companys").append(companySpanDom);
				}
				$("#"+handOverClientModalId+" .content-left-companys .client-name").click(function(){
					var clientData=$(this).data('client-data');
					$(this).addClass("active").siblings().removeClass("active");
					$("#"+handOverClientModalId+" .one-client-detail li[data-client-id]").addClass("hide");
					if($("#"+handOverClientModalId+" .one-client-detail li[data-client-id='"+clientData.client_id+"']").length>0){
						$("#"+handOverClientModalId+" .one-client-detail li[data-client-id='"+clientData.client_id+"']").removeClass("hide");
					}else {
						var clientLiDom=$("<li class='one-item'></li>");
						clientLiDom.attr("data-client-id",clientData.client_id);
						clientLiDom.append("<label><input type='checkbox' data-source-level='1' value='"+clientData.client_id+"'/><span class='css-overhidden' title='"+clientData.client_full_name+"'>"+clientData.client_full_name+"</span></label>")
						clientLiDom.find("input").data("permissions",clientData.permissions);
						$("#"+handOverClientModalId+" .one-client-detail").append(clientLiDom);
						for(var i in clientData.departments) {
							var depa=clientData.departments[i];
							var depaLiDom=$("<li class='one-item'></li>");
							depaLiDom.append("<label><input type='checkbox' data-source-level='2' value='"+depa.depa_id+"'/><span class='css-overhidden' title='"+depa.depa_name+"'>"+depa.depa_name+"</span></label>")
							depaLiDom.find("input").data("permissions",depa.permissions);
							$("#"+handOverClientModalId+" .one-client-detail>li>label input[value='"+clientData.client_id+"']").parent().parent().append(depaLiDom);
							for(var n in depa.contacts) {
								var contact=depa.contacts[n];
								var contactLiDom=$("<li class='one-item contact-li'></li>");
								contactLiDom.append("<label><input type='checkbox' disabled='disabled' data-source-level='3' value='"+contact.contact_id+"'/><span class='css-overhidden' title='"+contact.contact_name+"'>"+contact.contact_name+"</span></label>")
								contactLiDom.find("input").data("permissions",contact.permissions);
								$("#"+handOverClientModalId+" .one-client-detail li input[value='"+depa.depa_id+"']").parent().parent().append(contactLiDom);
							}
						}
					}
					$("#"+handOverClientModalId+" .one-client-detail li input").unbind("click").click(function(e){
						if($(this).attr("data-source-level")=="3") {
							$.showErrorGritter("移入公海的最小单位为科室/部门");
							return false;
						}
						onCheckBtnClick(this,$(this).attr("data-source-level")==2);
					});
				});
				$("#"+handOverClientModalId+" .content-left-companys .client-name:first-child").trigger("click");
			}
			
			////选择接收对象按钮
			////选择接收对象按钮
			$("#" + handOverClientModalId + " .btn-sel-accept-object").click(function() {
				////已选的接收对象
				var modalId = $.modal().show("选择公海范围", ".select-scope", function() {
					$("#" + modalId + " .select-scope-deparmenttree li").each(function(index) {

						if($(this).children("div").find("input:radio[name='huangguofei']:checked").val()) {
							$("#"+handOverClientModalId+" .no-tip").addClass("hide");
							$("#"+handOverClientModalId+" .selected-container").removeClass("hide");
							var strs = "<span data-id='" + $(this).attr("data-id") + "'>" + $(this).children("div").find("span").text() + "</span>";
							$("#" + handOverClientModalId + " .selected-container").empty().append(strs);
							$("#" + modalId).modal('hide');
						}
					});
				});
				$.ajaxGet(departmentUrl, function(response) {
					var companyDerpatTreeData = response.data;
					loadTree("", companyDerpatTreeData);
				});

				function loadTree(parentId, treeData) {
					for(var i in treeData) {
						var str = "<li data-id=" + treeData[i].depa_id + ">";
						str += "<div class='menu-title'>";
						str += "<i class='fa fa-minus-square-o' aria-hidden='true' onclick='treeUpDown(this)'></i>";
						str += "<lable><input type='radio' name='huangguofei'>";
						str += "<span class=''>" + treeData[i].depa_name + "</span></lable>";
						str += "</div>";
						str += "<ul>";
						str += "</ul>";
						str += "</li>";
						if(parentId == "") {
							$("#" + modalId + " .select-scope-deparmenttree").append(str);
						} else {
							$("#" + modalId + " .select-scope-deparmenttree li[data-id=" + parentId + "]>ul").append(str);
						}
						if(treeData[i].departments) {
							loadTree(treeData[i].depa_id, treeData[i].departments);
						}
					}
				}
			});

		} 
		//获取移入公害的客户数据
		function getIntoSeaData(notShowNullTip) {
			var tabViewAndPostData = {
				client:[],
				depa:[],
				contact:[]
			};
			$("#"+handOverClientModalId+" .client-name").each(function(){
				var thisPostData=$(this).data("post-data");
				if(!thisPostData) return true;
				var thisPostDataLevel=0;
				for(var i in thisPostData) {
					if(thisPostData[i].data_type==1) {
						//alert(1)
						thisPostDataLevel=1;
						break;
					}
					if(thisPostData[i].data_type==2&&thisPostDataLevel!=1) {
						//alert(2)
						thisPostDataLevel=2;
					}
					if(thisPostData[i].data_type==3&&thisPostDataLevel!=1&&thisPostDataLevel!=2) {
						//alert(3)
						thisPostDataLevel=3;
					}
				}
				if(thisPostDataLevel==1) tabViewAndPostData.client=tabViewAndPostData.client.concat(thisPostData);
				if(thisPostDataLevel==2) tabViewAndPostData.depa=tabViewAndPostData.depa.concat(thisPostData);
				if(thisPostDataLevel==3) tabViewAndPostData.contact=tabViewAndPostData.contact.concat(thisPostData);
			});
			if(tabViewAndPostData.client.length<1&&tabViewAndPostData.depa.length<1&&tabViewAndPostData.contact.length<1) {
				if(!notShowNullTip) $.showErrorGritter("请先选择移入的资源");
				return false;
			}
			return tabViewAndPostData;
		}
		////客户单位的删除按钮点击事件处理函数
		function onHandOverClientTabDeleteBtnClick(obj) {
			var type = $(obj).parents("tr").attr("class");
			onCheckBtnClick($("#"+handOverClientModalId+" input[value='"+$(obj).parent().parent().parent().attr("data-id")+"']"),true);
			$(obj).parent().parent().parent().remove();
		}
		//选中按钮点击事件处理函数
		function onCheckBtnClick(obj,isCancelChild) {
			var permissions=$(obj).data("permissions");
			//实现勾选逻辑
			if(!$(obj).is(":checked")) {
				//$(obj).removeProp("checked");
				$(obj).parents("li").each(function(){
					$(this).find(">label input").removeProp("checked");
				});
				if(isCancelChild) {
					$(obj).parent().parent().find("input").each(function(){
						$(this).removeProp("checked");
					})
				}
			}else{
				if(!permissions.can_into_sea.result) {
					$.showErrorGritter("当前资源处于"+permissions.can_into_sea.reason+"中，不能移交！");
					$(obj).removeProp("checked");
					return false;
				}
				//$(obj).prop("checked","checked");
				$(obj).parent().parent().find("li input").prop("checked","checked");
			}
			var postData=[];
			$("li[data-client-id='"+$("#"+handOverClientModalId+" .client-name.active").attr("data-client-id")+"'] input:checked").each(function(){
				var transfer_data={};
				transfer_data.data_type=$(this).attr("data-source-level");
				transfer_data.data_id=$(this).val();
				if(transfer_data.data_type==1) {
					transfer_data.client_full_name=$(this).parent().find("span").text();
				}
				if(transfer_data.data_type==2) {
					transfer_data.client_full_name=$(this).parent().parent().parent().find(">label span").text();
					transfer_data.depa_name=$(this).parent().find("span").text();
				}
				if(transfer_data.data_type==3) {
					transfer_data.client_full_name=$(this).parent().parent().parent().parent().find(">label span").text();
					transfer_data.depa_name=$(this).parent().parent().parent().find(">label span").text();
					transfer_data.contact_name=$(this).parent().find("span").text();
				}
				postData.push(transfer_data);
			});
			$("#"+handOverClientModalId+" .client-name.active").data("post-data",postData);
			if(postData.length>0) $("#"+handOverClientModalId+" .client-name.active").addClass("select");
			else $("#"+handOverClientModalId+" .client-name.active").removeClass("select");
			writeTable(true);
		}
		function writeTable(notShowNullTip) {
			postData = [];
			$("#" + handOverClientModalId + " #tab-hand-over-content tbody").html("");
			////先读取数据
			var tabViewAndPostData = getIntoSeaData(notShowNullTip);
			appendHandOverDataTabHtml(tabViewAndPostData);
			//组织好提交的数据
			postData = postData.concat(tabViewAndPostData.client).concat(tabViewAndPostData.depa).concat(tabViewAndPostData.contact);
			////点击右边表格删除按钮  表格   左边树状图状态改变
			$(".del-tab-view").click(function() {
				onHandOverClientTabDeleteBtnClick(this);
			});
		}
		//获得显示到表格里面的HTML
		function appendHandOverDataTabHtml(tabViewAndPostData) {
			if(tabViewAndPostData.client.length>0){
				var $companyDom=
					$("<tr class='client-tr'>"
					+"	<td>客户单位</td>"
					+"	<td>"
					+"		<ul></ul>"
					+"	</td>"
					+"</tr>");
				for(var i in tabViewAndPostData.client){
					if(tabViewAndPostData.client[i].data_type!=1) continue;
					var $AClientDom=
						$("<li data-id='"+tabViewAndPostData.client[i].data_id+"'>"
						+"	<div class='item at'>"
						+"		<div class='lt'>"+tabViewAndPostData.client[i].client_full_name+"</div>"
						+"		<div class='lt'><a class='btn-a-default' onclick='onHandOverClientTabDeleteBtnClick(this)'>删除</a></div>"
						+"	</div>"
						+"</li>");
						$AClientDom.attr("data-id",tabViewAndPostData.client[i].client_id);
					$companyDom.find("ul").append($AClientDom);
				}
				$("#"+handOverClientModalId+" #tab-hand-over-content tbody").append($companyDom);
			}
			if(tabViewAndPostData.depa.length>0){
				var $depaDom=
					$("<tr class='client-tr'>"
					+"	<td>科室/部门</td>"
					+"	<td>"
					+"		<ul></ul>"
					+"	</td>"
					+"</tr>");
				for(var i in tabViewAndPostData.depa){
					if(tabViewAndPostData.depa[i].data_type!=2) continue;
					var $ADepaDom=
						$("<li data-id='"+tabViewAndPostData.depa[i].data_id+"'>"
						+"	<div class='item at'>"
						+"		<div class='lt'>"
						+"			<span style='color:#999;'>"+tabViewAndPostData.depa[i].client_full_name+"-</span>"
						+"			<span>"+tabViewAndPostData.depa[i].depa_name+"</span>"
						+"		</div>"
						+"		<div class='lt'><a class='btn-a-default' onclick='onHandOverClientTabDeleteBtnClick(this)'>删除</a></div>"
						+"	</div>"
						+"</li>");
					$ADepaDom.attr("data-id",tabViewAndPostData.depa[i].depa_id);	
					$depaDom.find("ul").append($ADepaDom);
				}
				$("#"+handOverClientModalId+" #tab-hand-over-content tbody").append($depaDom);
			}
			if(tabViewAndPostData.contact.length>0){
				var $contactDom=
					$("<tr class='client-tr'>"
					+"	<td>联系人</td>"
					+"	<td>"
					+"		<ul></ul>"
					+"	</td>"
					+"</tr>");
				for(var i in tabViewAndPostData.contact){
					if(tabViewAndPostData.contact[i].data_type!=3) continue;
					var $AContactDom=
						$("<li data-id='"+tabViewAndPostData.contact[i].data_id+"'>"
						+"	<div class='item at'>"
						+"		<div class='lt'>"
						+"			<span style='color:#999;'>"+tabViewAndPostData.contact[i].client_full_name+"></span>"
						+"			<span style='color:#999;'>"+tabViewAndPostData.contact[i].depa_name+"></span>"
						+"			<span>"+tabViewAndPostData.contact[i].contact_name+"</span>"
						+"		</div>"
						+"		<div class='lt'><a class='btn-a-default' onclick='onHandOverClientTabDeleteBtnClick(this)'>删除</a></div>"
						+"	</div>"
						+"</li>");
					$AContactDom.attr("data-id",tabViewAndPostData.contact[i].contact_id);	
					$contactDom.find("ul").append($AContactDom);
				}
				$("#"+handOverClientModalId+" #tab-hand-over-content tbody").append($contactDom);
			}
		}
		function treeUpDown(obj) {
			if($(obj).hasClass("fa-minus-square-o")) {
				$(obj).removeClass("fa-minus-square-o").addClass("fa-plus-square-o");
				$(obj).parent().next().slideUp();
			} else {
				$(obj).removeClass("fa-plus-square-o").addClass("fa-minus-square-o");
				$(obj).parent().next().slideDown();
			}
		}
		//客户信息
		function clientInfo(event, obj) {
			var clienId = $(obj).attr("data-clientid");
			var packageId = $(obj).attr("id");
			var state = $(obj).data("state");
			var modalId = $.modal({
				showOKButton: false,
				cancelButtonText: "关闭",
				height: $(window).height()-200,
				width: 900,
				shownCallback: function (){
					//$("#"+modalId+ " .")
				}
			}).show("客户信息", ".client-information", function() {

			});
			//默认显示我的客户显示样式
			$("#" + modalId + " .movepubilc-nav li:first-child").addClass("chenkstyle");
			if(state == publicClientState.approve)
				$("#" + modalId + " .client-info-top-menu img").remove();
			$("#"+modalId+" .client-info-tab").css({
				height: $("#"+modalId+" .modal-body").outerHeight(true)
						-$("#"+modalId+" .client-info-top").outerHeight(true)
						-$("#"+modalId+" .movepubilc-nav").outerHeight(true)-120+"px",
			});
			//点击切换选项
			$("#"+modalId+" .movepubilc-nav li").unbind("click").click(function(){
				changClienttab(this,modalId);
			});
			var clientInfoUrl = BSAPIURL + "/crm_seas_manage/query_one_sea_customer?package_data_client_id=" + clienId + "&package_id=" + packageId;
			$.ajaxGet(clientInfoUrl, function(response) {
				var infoData = response.data.client_info;
				clientInfoData = response.data;
				//loadClientInfo(response.data)
				var departmentoption = "#" + modalId;
				var comController = new Controller(departmentoption);
				infoData.client_administrative_division_cn=infoData.client_administrative_division_cn?"（"+infoData.client_administrative_division_cn+"）":"";
				comController.set(infoData);
				$("#" + modalId + " .group-handle").data({
					"id": packageId,
					"name": "《" + infoData.client_full_name + "》",
					"type": businessGroupCode.publics
				});
				//表格加载
				$("#" + modalId + " .client-deparyinfo-tabs").attr("id", "client-deparytab-info");
				$("#" + modalId + " .client-linkmaninfo-tabs").attr("id", "client-linkmantab-info");
				clientDeparInfoTab = "#client-deparytab-info";
				clientLinkmanInfoTab = "#client-linkmantab-info";
				changClienttab("#" + modalId + " .movepubilc-nav li:first-child",modalId);
			});
			//群操作
			$("#" + modalId + " .client-info-top-menu .group-handle").unbind("click").click(function() {
				$(this).data("type", businessGroupCode.publics);
				groupHandle($(this));
			});
		}
		//客户信息表格切换
		function changClienttab(obj,modalId) {
			var gridHeight=$("#"+modalId+" .client-info-tab").outerHeight(true);//-$("#"+modalId+" .movepubilc-nav").outerHeight(true);
			$(obj).addClass("chenkstyle").siblings().removeClass("chenkstyle");
			if($(obj).parent().children(".chenkstyle").text() != "联系人") {
				$(".client-info-tab #gbox_client-deparytab-info").removeClass("hide").siblings().addClass("hide");
				var colNames = ['', '科室/部门名称', '重要等级', '门诊量', '床位数', '年销量（万元）', '最近拜访量'];
				var colModel = [{
					name: 'id',
					index: 'id',
					hidden: true,
					formatter: function(cellvalue, options, rowObject) {
						return rowObject.depa_id;
					}
				}, {
					name: 'depa_name'
				}, {
					name: 'depa_important_level_cn'
				}, {
					name: 'depa_outpatients_count'
				}, {
					name: 'depa_sickbeds_count'
				}, {
					name: 'annual_sale_count'
				}, {
					name: 'recent_visit_count'
				}];
				clientDeparInfoGrid = $(clientDeparInfoTab).initJqGrid({
					grid_selector: clientDeparInfoTab,
					colNames: colNames,
					colModel: colModel,
					autowidth: false,
					width: 854,
					height: gridHeight,
					multiselect: false,
					datatype: "local"
				});
				loadClientInfo(clientInfoData.department_arr, clientDeparInfoTab);
			} else {
				$(".client-info-tab #gbox_client-deparytab-info").addClass("hide").siblings().removeClass("hide");
				var colNames = ['', '姓名', '重要等级', '科室部门', '职务', '职称', '年销量（万元）', '最近拜访量'];
				var colModel = [{
					name: 'id',
					index: 'id',
					hidden: true,
					formatter: function(cellvalue, options, rowObject) {
						return rowObject.contact_id;
					}
				}, {
					name: 'contact_name'
				}, {
					name: 'contact_important_level_cn'
				}, {
					name: 'depa_name'
				}, {
					name: 'contact_positional_titles'
				}, {
					name: 'contact_job_position'
				}, {
					name: 'annual_sale_count'
				}, {
					name: 'recent_visit_count'
				}];
				clientLinkmanInfoGrid = $(clientLinkmanInfoTab).initJqGrid({
					grid_selector: clientLinkmanInfoTab,
					colNames: colNames,
					colModel: colModel,
					autowidth: false,
					width: 854,
					height: gridHeight,
					multiselect: false,
					datatype: "local"
				});
				loadClientInfo(clientInfoData.contact_arr, clientLinkmanInfoTab);
			}
		}
		//加载客户信息表格数据
		function loadClientInfo(infoData, clientInfoGrid) {
			$(clientInfoGrid).jqGrid("clearGridData");
			for(var i = 0; i < infoData.length; i++) {
				$(clientInfoGrid).jqGrid('addRowData', i + 1, infoData[i]);
			}
		}
		//点击无反应
		function noClick(event, obj) {
			var e = window.event || event;
			if(e.stopPropagation) { //如果提供了事件对象，则这是一个非IE浏览器 
				e.stopPropagation();
			} else {
				//兼容IE的方式来取消事件冒泡 
				window.event.cancelBubble = true;
			}
		}
		//抢客户
		function robClient(event, obj) {
			var ids = {};
			//event.stopPropagation();
			var e = window.event || event;
			if(e.stopPropagation) { //如果提供了事件对象，则这是一个非IE浏览器 
				e.stopPropagation();
			} else {
				//兼容IE的方式来取消事件冒泡 
				window.event.cancelBubble = true;
			}
			var clienId = $(obj).parents(".list-box").attr("data-clientid");
			var packageId = $(obj).parents(".list-box").attr("id");
			var modalId = $.modal({
				width: 650,
				height: $(window).height()-200,
				showFooter: false,
				shownCallback: function(){
					$("#"+modalId+" .rob-client .step-panel-1").css("height",$("#"+modalId+" .rob-client").outerHeight(true)-90+"px");
				}
			}).show("抢客户", ".rob-client-container", function() {
			});
			$("#"+modalId+" .rob-client-fotter-btns a").attr("data-curr-step",1);
			$("#"+modalId+" .btn-next-step").click(function(){
				var currStep=parseInt($(this).attr("data-curr-step"));
				if(currStep==1){
					if($("#"+modalId+" .department-tree input:checked").length<1) {
						$.showErrorGritter("请先选择您要抢取的客户！");
						return false;
					}
					$("#"+modalId+" .step-panel").addClass("hide");
					$("#"+modalId+" .step-panel-"+(currStep+1)).removeClass("hide");
					$("#"+modalId+" .rob-client-fotter-btns a").attr("data-curr-step",currStep+1);
					$(this).text("上一步");
					$("#"+modalId+" .btn-ok").removeClass("hide");
				}else{
					$("#"+modalId+" .step-panel").addClass("hide");
					$("#"+modalId+" .step-panel-"+(currStep-1)).removeClass("hide");
					$("#"+modalId+" .rob-client-fotter-btns a").attr("data-curr-step",currStep-1);
					$(this).text("下一步");
					$("#"+modalId+" .btn-ok").addClass("hide");
				}
			});
			$("#"+modalId+" .btn-ok").click(function(){
				var formContainer = "#" + modalId + " form";
				var infoController = new Controller(formContainer);
				var infoData = infoController.getJSON();
				infoData.package_id = packageId;
				infoData.package_data_client_id = clienId;
				var ids=readPostData();
				//客户列表
				infoData.client_id_arr = ids.client_id_arr;
				//联系人列表
				infoData.contact_id_arr = ids.contact_id_arr;
				//					//部门列表
				infoData.department_id_arr = ids.department_id_arr;
				var clientObjectId = [];
				$.ajaxPost(robClientUrl, infoData, function(response) {
					if(response.code == 0) {
						//success
						$.showSuccessGritter("您的抢客户申请已提交，请等待审批结果。");
						$("#" + modalId).modal('hide');
						//刷新公海列表
						loadClientPackageList(true,'','');

					} else {
						$.showErrorGritter("抢客户申请失败：" + response.msg);
					}
				});
			});
			$("#"+modalId+" .btn-cancel").click(function(){
				$("#"+modalId).modal('hide');
			});
			//加载部门树'
			var clientInfoUrl = BSAPIURL + "/crm_seas_manage/query_one_sea_customer?package_data_client_id=" + clienId + "&package_id=" + packageId;
			$.ajaxGet(clientInfoUrl, function(response) {
				var deparTreeInfoData = response.data;
				console.log(deparTreeInfoData);
				var clientStr = "<li id=" + deparTreeInfoData.client_info.client_id + ">";
				clientStr += "<div class='company-container' data-can-pick=" + deparTreeInfoData.client_info.can_pick_up + ">";
				clientStr += "<label><input type='checkbox' value='"+deparTreeInfoData.client_info.client_id+"' />";
				clientStr += "<span class='tree-name'>" + deparTreeInfoData.client_info.client_full_name + "</span></label>";
				clientStr += "</div>";
				clientStr += "<ul>";
				clientStr += "</ul>";
				clientStr += "</li>";
				$("#" + modalId + " .department-tree").append(clientStr);
				for(var i in deparTreeInfoData.department_arr) {
					var deparData = deparTreeInfoData.department_arr[i];
					var deparStr = "<li id=" + deparData.depa_id + ">";
					deparStr += "<div class='dept-container' data-can-pick=" + deparData.can_pick_up + ">";
					deparStr += "<label><input type='checkbox' value='"+deparData.depa_id+"' />";
					deparStr += "<span class='tree-name'>" + deparData.depa_name + "</span></label>";
					deparStr += "</div>";
					deparStr += "<ul>";
					deparStr += "</ul>";
					deparStr += "</li>";
					$("#" + deparTreeInfoData.client_info.client_id + ">ul").append(deparStr);
				}
				for(var i in deparTreeInfoData.contact_arr) {
					var contactData = deparTreeInfoData.contact_arr[i];
					var deparStr = "<li id=" + contactData.contact_id + ">";
					deparStr += "<div class='contact-container' data-can-pick=" + contactData.can_pick_up + ">";
					deparStr += "<label><input disabled='disabled' type='checkbox' value='"+contactData.contact_id+"' />";
					deparStr += "<span class='tree-name'>" + contactData.contact_name + "</span></label>";
					deparStr += "</div>";
					deparStr += "<ul>";
					deparStr += "</ul>";
					deparStr += "</li>";
					$("#" + deparTreeInfoData.client_info.client_id + " li").each(function(index) {
						if($(this).attr("id") == contactData.depa_id) {
							$(this).children("ul").append(deparStr);
						}
					});
				}
//				$("#"+modalId+ " .department-tree label input").click(function(e){
//					e.stopPropagation();
//					e.preventDefault();
//				});
				$("#"+modalId+ " .department-tree input").unbind("click").change(function(){
					if($(this).parent().parent().attr("data-can-pick")=="false"){
						$.showErrorGritter("当前客户不可以抢取");
						$(this).removeProp("checked");
						return false;
					}
					if(!$(this).is(":checked")) {
						$(this).parent().parent().parent().find("ul input").removeProp("checked");
						$(this).removeProp("checked");
					}else{
						$(this).prop("checked","checked");
						$(this).parent().parent().parent().find("ul input").each(function(){
							if($(this).parent().parent().attr("data-can-pick")=="true"){
								$(this).prop("checked","checked");
							}
						});
					}
				});

			});
			////组装数据
			function readPostData() {
				var clientLiSelector = $("#" + modalId + " .rob-client-left .department-tree>li");
				var client_id_arr = [],
					contact_id_arr = [],
					department_id_arr = [];
				if(clientLiSelector.find(">div input").prop("checked")) client_id_arr.push(clientLiSelector.attr("id"));
				clientLiSelector.find(">ul>li").each(function() {
					if($(this).find(">div input").prop("checked")) department_id_arr.push($(this).attr("id"));
					$(this).find(">ul li").each(function() {
						if($(this).find(">div input").prop("checked")) contact_id_arr.push($(this).attr("id"));
					});
				});
				ids.client_id_arr = client_id_arr;
				ids.contact_id_arr = contact_id_arr;
				ids.department_id_arr = department_id_arr;
				return ids;
			}

		}
		//判断部门是否全部选中
		function isSelectAllDept(obj) {
			var isSelectAllDepts = true;
			if($(obj).parent().hasClass("dept-container")) {
				$(obj).parent().parent().siblings().each(function() {
					if(!$(this).find(">div>i:first-child").hasClass("checkstyle")) {
						isSelectAllDepts = false;
						return true;
					}
				});
			}
			return isSelectAllDepts;
		}
		//子部门取消选中是判断是否取消上级选中
		function isCancelTop(obj) {
			obj.find("li").each(function(index) { //遍历所有
				var isAllSelect = true;
				$(this).find(">ul>li").each(function() { //遍历子li
					if(!$(this).children("div .fa-check-circle").hasClass("checkstyle")) {
						isAllSelect = false;
					}
				});
				if(!isAllSelect) {
					$(this).children(">div").children(".fa-check-circle").removeClass("checkstyle");
				}
			});
		}
		//树下拉上收
		function treeZoom(obj) {
			if($(obj).hasClass("fa-sort-desc")) {
				$(obj).removeClass("fa-sort-desc").addClass("fa-caret-right");
				$(obj).parent().next().slideUp();
			} else {
				$(obj).removeClass("fa-caret-right").addClass("fa-sort-desc");
				$(obj).parent().next().slideDown();
			}
		}
		//处理信息(客户列表)
		function dispose(event, obj, num, canHandle) {
			var e = window.event || event;
			if(e.stopPropagation) { //如果提供了事件对象，则这是一个非IE浏览器 
				e.stopPropagation();
			} else {
				//兼容IE的方式来取消事件冒泡 
				window.event.cancelBubble = true;
			}
			if(!canHandle) {
				$.showErrorGritter("您没有权限处理该包！");
				return false;
			}
			if(num == 0) {
				$.showErrorGritter("没有待处理信息");
				return false;
			}
			var modalId = $.modal({
				showFooter: false,
				height: $(window).height()-100,
				width: $(window).width()-200>900?900:$(window).width()-100,
				shownCallback: function(){
					applyforListClientId = $(obj).parents(".list-box").attr("data-clientid");
					applyforListpackId = $(obj).parents(".list-box").attr("id");
					applyforListPlace = modalId;
					loadApplyforList(applyforListClientId, applyforListpackId, applyforListPlace);
				}
			}).show("申请列表", ".apple-list", function() {

			});

		}
		//加载申请列表
		var hasItemApproving = false;

		function loadApplyforList(clienId, packageId, modalId) {
			$("#" + modalId + " .apple-list-main-right").empty();
			//加载数据
			$.ajaxGet(packageApplyForListUrl + "?client_id=" + clienId + "&package_id=" + packageId, function(response) {
				disposeClientInfoData = response.data;
				var departmentoption = "#" + modalId;
				var comController = new Controller(departmentoption);
				comController.set(disposeClientInfoData);
				$(departmentoption + " .apple-list-menu i").data({
					"id": packageId,
					"name": "公海包," + disposeClientInfoData.client_profile.client_full_name
				});

				$("#" + modalId + " .apple-list-menu i").unbind("click").click(function() {
					groupHandle($(this), groupCode.publics);
				});
				for(var i in disposeClientInfoData.pickup_list) {
					var str =
					"<div class='apple-list-box' onclick='openApplyforInfo(this,\"#"+modalId+"\")' id='" + disposeClientInfoData.pickup_list[i].request_id + "'>"
					+"	<div class='apple-list-box-top at'>"
					+"		<img class='list-box-head lt' src='" + disposeClientInfoData.pickup_list[i].request_employee_avatar + "'>"
					+"		<div class='lt'>"
					+"			<span class='list-box-name css-overhidden vert-top' title='" + disposeClientInfoData.pickup_list[i].request_employee_name + "'>" + disposeClientInfoData.pickup_list[i].request_employee_name + "</span>"
					+"			<br><span class='list-box-time vert-top' style='font-size:12px;'>" + disposeClientInfoData.pickup_list[i].request_date + "</span>"
					+"		</div>"
					+"		<span class='month-sale-num rt'>承诺月销量<span>" + disposeClientInfoData.pickup_list[i].request_sales_commitment_month6+"</span>万元</span>"
					+"	</div>"
					+"	<p class='apple-list-box-middle'>"
					+"		<span>宣言：</span>"
					+"		<span class='list-box-txt'>" + disposeClientInfoData.pickup_list[i].request_a_word_declaration + "</span>"
					+"	</p>"
					+"	<p class='apple-list-box-bottom'>";
					var isAllowClick = "";
					if(!disposeClientInfoData.pickup_list[i].can_handle) {
						isAllowClick = "style=\"cursor: not-allowed;\"";
					}
					if(disposeClientInfoData.pickup_list[i].request_status == "1") { //申请中
						str += "<a class='btn def-btn btn-info def-btn-info def-btn-sm btn-sm'  " + isAllowClick + " onclick=\"giveTa(this," + disposeClientInfoData.pickup_list[i].request_status + ",'" + disposeClientInfoData.pickup_list[i].request_employee_id + "','" + disposeClientInfoData.pickup_list[i].request_id + "','1'," + disposeClientInfoData.pickup_list[i].can_handle + ")\">给ta</a>";
						str += "<a class='btn def-btn btn-danger def-btn-danger def-btn-sm btn-sm'  " + isAllowClick + " onclick=\"giveTa(this," + disposeClientInfoData.pickup_list[i].request_status + ",'" + disposeClientInfoData.pickup_list[i].request_employee_id + "','" + disposeClientInfoData.pickup_list[i].request_id + "','2'," + disposeClientInfoData.pickup_list[i].can_handle + ")\">不给ta</a>";
					} else if(disposeClientInfoData.pickup_list[i].request_status == "2") { //锁定
						str += "<a class='btn btn-primary def-btn def-btn-primary def-btn-sm btn-sm' disabled='disabled' " + isAllowClick + " onclick=\"giveTa(this," + disposeClientInfoData.pickup_list[i].request_status + ",'" + disposeClientInfoData.pickup_list[i].request_employee_id + "','" + disposeClientInfoData.pickup_list[i].request_id + "','1'," + disposeClientInfoData.pickup_list[i].can_handle + ")\">给ta</a>";
						str += "<a class='btn def-btn btn-danger def-btn-danger def-btn-sm btn-sm'  " + isAllowClick + " onclick=\"giveTa(this," + disposeClientInfoData.pickup_list[i].request_status + ",'" + disposeClientInfoData.pickup_list[i].request_employee_id + "','" + disposeClientInfoData.pickup_list[i].request_id + "','2'," + disposeClientInfoData.pickup_list[i].can_handle + ")\">不给ta</a>";
					} else if(disposeClientInfoData.pickup_list[i].request_status == "3") { //审批中
						hasItemApproving = true;
						str += "<span class='applyfor-state def-btn btn btn-primary def-btn-primary def-btn-sm btn-sm'>审批中</span>";
					} else if(disposeClientInfoData.pickup_list[i].request_status == "4") { //成功
						str += "<span class='applyfor-state def-btn btn btn-primary def-btn-primary def-btn-sm btn-sm'>已给Ta</span>";
					} else { //失败
						str += "<span class='applyfor-state def-btn btn btn-primary def-btn-primary def-btn-sm btn-sm'>已拒绝</span>";
					}
					str += "</p>";
					str += "</div>";
					$("#" + modalId + " .apple-list-main-right").append(str);
				}
				$("#" + modalId + " .apple-list-box").eq(0).addClass("clickstyle");
				if(hasItemApproving) $("#" + modalId + " .apple-list-main-right").data("has-approving", true);
				openApplyforInfo("#" + modalId + " .apple-list-box:first-child","#"+modalId);
				$("#"+modalId+" .apple-list-main").css({
					"height": $("#"+modalId+" .modal-body").outerHeight(true)-$("#"+modalId+" .apple-list-menu").outerHeight(true)-$("#"+modalId+" .apple-list-additioninfo").outerHeight(true)-30+"px"
				});
			});
		}
		//给他
		function giveTa(obj, requestStatus, request_employee_id, id, isIndex, isClick) {
			if(!isClick) {
				$.showErrorGritter('只有直接上级才能进行操作！');
				return false;
			}
			if(id != "") {
				if(isIndex == 1) {
					if(requestStatus != 1) {
						$.showErrorGritter("此资源的”给Ta“操作正在审批中，不能给ta");
						return false;
					}
					var modalId = $.modal().show("提示", ".applyfor", function() {
						$.showApprovalPostPop({
							routine: "clientPickUp",
							routineName: "抢客户",
							exceptIds: request_employee_id,
							isIncludeSelf: true,
							publicClientId: request_employee_id,
							successCallback: function(apvData, apvModal) {
								if(apvData.needApv) {
									apvData.diy_step_data = apvData.steps;
									apvData.plan_id = apvData.planId;
								}
								apvData.request_approve = isIndex;
								apvData.request_id = id;

								$.ajaxPost(robClientApplyforUrl, apvData, function(response) {
									if(response.code == 0) {
										//success
										//$.modal().alert("提交申请成功");
										if(apvData.needApv) {
											$.modal().confirm("提交申请成功", function() {
												//apvModal.modal('hide');
												$("#" + modalId).modal('hide');
												apvModal && apvModal.modal("hide");
											});
										} else {
											$("#" + modalId).modal('hide');
											apvModal && apvModal.modal("hide");
										}
										loadApplyforList(applyforListClientId, applyforListpackId, applyforListPlace);
									} else {
										$.showErrorGritter("提交申请失败：" + response.msg);
									}
								});
							}
						});
					});
				} else {
					var modalId = $.modal().show("提示", ".applyfor", function() {
						var apvData = {};
						apvData.request_approve = isIndex;
						apvData.request_id = id;
						$.ajaxPost(robClientApplyforUrl, apvData, function(response) {
							if(response.code == 0) {
								//success
								$.showSuccessGritter("拒绝成功");
								$("#" + modalId).modal("hide");
								loadApplyforList(applyforListClientId, applyforListpackId, applyforListPlace);
							} else {
								$.showErrorGritter("拒绝失败：" + response.msg);
							}
						});
					});
					$("#" + modalId + " p").html("确定拒绝该员工的申请？");
				}
			} else {
				$.modal().alert("此客户已被别人抢先下手啦");
			}
		}
		//打开个人申请详情
		function openApplyforInfo(obj,modalId) {
			$(obj).parents(".apple-list-main").find(".apple-list-main-left .rob-list").remove();
			console.log(disposeClientInfoData);
			$(obj).addClass("clickstyle").siblings().removeClass("clickstyle");
			$(obj).parent().children().each(function(index) {
				if($(this).hasClass("clickstyle")) {
					for(var i in disposeClientInfoData.pickup_list) {
						if($(obj).attr("id") == disposeClientInfoData.pickup_list[i].request_id) {
							$(obj).parents(".apple-list-main").find(".rob-menu").siblings().empty();
							for(var j in disposeClientInfoData.pickup_list[i].source_list) {
								if(disposeClientInfoData.pickup_list[i].source_list[j].package_data_type == "1") {
									var infoData = disposeClientInfoData.pickup_list[i].source_list[j];
									var str = "<div class=\"apple-list-client rob-list\" data-id=" + infoData.package_data_source_id + "><span class='label-name'>客户单位：</span><span class='rob-detail'>" + infoData.client_full_name + "</span></div>";
									$(obj).parents(".apple-list-main").find(".rob-main").append(str);
									var depasStrArr = [];
									var strArr = [];
									for(var k in disposeClientInfoData.pickup_list[i].source_list[j].depas) {
										var depasInfo = disposeClientInfoData.pickup_list[i].source_list[j].depas[k];
										var depaStr = "<span data-id=" + depasInfo.depa_id + ">" + depasInfo.depa_name + "</span>";
										depasStrArr.push(depaStr);
										if(!depasInfo.contacts) continue;
										strArr[k] = [];
										for(var c in depasInfo.contacts) {
											var contactStr = "<span data-id=" + depasInfo.contacts[c].contact_id + ">" + depasInfo.contacts[c].contact_name + "</span>";
											if(c == 0) contactStr = depasInfo.depa_name + ">" + contactStr;
											strArr[k].push(contactStr);
										}
									}
									$(obj).parents(".apple-list-main").find(".rob-main").append("<div class=\"rob-list\">" + "<span class='label-name'>科室/部门：</span><span class='rob-detail'>" + depasStrArr.join("<br>") + "</span></div>");
									console.log(strArr)
									for(var m in strArr) {
										if(strArr[m].length > 0) $(obj).parents(".apple-list-main").find(".rob-main").append("<div class=\"rob-list\"><span style='display: inline-block;width: 70px;'>" + (m == 0 ? "<span class='label-name'>联系人：</span>" : "") + "</span><span class='rob-detail'>" + strArr[m].join("、") + "</span></div><br>");
									}
								}
							}
							var nameData = [];
							var str = "";
							for(var j in disposeClientInfoData.pickup_list[i].source_list) {
								var infoData = disposeClientInfoData.pickup_list[i].source_list[j];
								if(infoData.package_data_type == "2") {
									if(infoData.contacts) {
										if(infoData.contacts.length > 0) str += infoData.depa_name + ">";
										for(var s in infoData.contacts) {
											if(s != infoData.contacts.length - 1) {
												str += infoData.contacts[s].contact_name + ",";
											} else {
												str += infoData.contacts[s].contact_name;
											}
										}
										str+="<br>";
									}
									nameData.push(infoData.depa_name);
								}
							}
							if(nameData.length > 0) {
								var strDepa = "<div class='rob-list'><span class='label-name'>科室/部门：</span><span class='rob-detail'>" + nameData.join("、") + "</span></div>";
								$(obj).parents(".apple-list-main").find(".rob-main").append(strDepa);
							}
							$(obj).parents(".apple-list-main").find(".rob-main").append("<div class='rob-list'>" + (str ? "<span class='label-name'>联系人：</span><span class='rob-detail'>" + str+"</span>" : "") + "</div>");
							var str1 = "<p class='rob-list css-overhidden'>第 1 个月，销量<span class='sale-surpose'>" + disposeClientInfoData.pickup_list[i].request_sales_commitment_month1 + "</span>万元</p>";
							$(obj).parents(".apple-list-main").find(".rob-commitment").append(str1);
							var str2 = "<p class='rob-list css-overhidden'>第 3 个月，销量<span class='sale-surpose'>" + disposeClientInfoData.pickup_list[i].request_sales_commitment_month3 + "</span>万元</p>";
							$(obj).parents(".apple-list-main").find(".rob-commitment").append(str2);
							var str3 = "<p class='rob-list css-overhidden'>第 6 个月，月均销量<span class='sale-surpose'>" + disposeClientInfoData.pickup_list[i].request_sales_commitment_month6 + "</span>万元</p>";
							$(obj).parents(".apple-list-main").find(".rob-commitment").append(str3);
							$(obj).parents(".apple-list-main").find(".rob-plan").append("<div class='rob-list'>" + disposeClientInfoData.pickup_list[i].request_sales_plans + "</div>");
						}
					}
				}
			});
			//$("#"+modalId+" .apple-list-main-left")
//			var timer=setTimeout(function(){
//				clearTimeout(timer);
//				timer=null;
////				$(modalId+" .apple-list-main-left .rob-plan .rob-list").css({
////					height: $(modalId+" .apple-list-main .apple-list-main-left").outerHeight(true)-
////						$(modalId+" .apple-list-main-left .rob-main").outerHeight(true)-
////						$(modalId+" .apple-list-main-left .rob-commitment").outerHeight(true)-
////						$(modalId+" .apple-list-main-left .rob-plan .rob-menu").outerHeight(true)-10+"px",
////					"overflow-y": "auto"
////				});
//			},0);
		}
		//客户状态返回
		function clientState(index) {
			console.log(index)
			switch(index) {
				case "1":
					return "<span class='state-bad'>审批中</span>";
					break;
				case "2":
					return "<span class='state-show'>新包</span>";
					break;
				case "3":
					return "<span class='state-show'>可领取</span>";
					break;
				default:
					return "<span class='state-bad'>已领完</span>";
			}
		}
		//专用于判断按钮是否可以操作的 函数   
		//定义各种类型按钮需要判断的状态
		var approvingTypeChecked = {
			into_sea: ["transfer", "into_sea", "share", "change_status", "change_visit"]
		}
		//判断点击的操作按钮是否有点击限制
		function boolCanClickBtn(data, type) {
			if(type == "update") type = "modify";
			for(var i = 0; i < data.length; i++) {
				if((type == "share" || type == "transfer" || type == "into_sea")) {
					if(!data[i].client_permissions["can_" + type].result) {
						if(!data[i].is_sub_resource_responsible_person && !data[i].is_sub_employee_sub_resource_responsible_person) {
							$.showErrorGritter("客户“" + data[i].client_full_name + "“" + data[i].client_permissions["can_" + type].reason + "，且非子资源负责人，不能进行此操作！");
							return false;
						} else if(data[i].is_sub_resource_responsible_person || data[i].is_sub_employee_sub_resource_responsible_person) {
							return true;
						} else {
							$.showErrorGritter("客户“" + data[i].client_full_name + "“" + data[i].client_permissions["can_" + type].reason + "，不能进行此操作！");
							return false;
						}

					}
					return true;
				}
				if(!data[i].client_permissions["can_" + type].result) {
					$.showErrorGritter("客户“" + data[i].client_full_name + "“" + data[i].client_permissions["can_" + type].reason + "，不能进行此操作！");
					return false;
				}
			}
			return true;
		}
	</script>

</html>